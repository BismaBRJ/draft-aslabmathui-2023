<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab Praktikum Departemen Matematika FMIPA UI - Modul 6 Persamaan Diferensial Numerik: Metode Shooting dan Linear Finite Difference untuk Masalah Nilai Batas PDB</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Lab Praktikum Departemen Matematika FMIPA UI</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../semuahalaman/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../semuahalaman/praktikum.html"> 
<span class="menu-text">Praktikum</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#review-runge-kutta-orde-4-untuk-sistem" id="toc-review-runge-kutta-orde-4-untuk-sistem" class="nav-link active" data-scroll-target="#review-runge-kutta-orde-4-untuk-sistem">Review: Runge-Kutta orde 4 untuk sistem</a></li>
  <li><a href="#linear-shooting" id="toc-linear-shooting" class="nav-link" data-scroll-target="#linear-shooting"><em>Linear Shooting</em></a>
  <ul class="collapse">
  <li><a href="#bentuk-umum-ide-utama-penyederhanaan" id="toc-bentuk-umum-ide-utama-penyederhanaan" class="nav-link" data-scroll-target="#bentuk-umum-ide-utama-penyederhanaan">Bentuk umum, ide utama, penyederhanaan</a></li>
  <li><a href="#function-file-dari-pseudocode-di-buku" id="toc-function-file-dari-pseudocode-di-buku" class="nav-link" data-scroll-target="#function-file-dari-pseudocode-di-buku">Function file (dari pseudocode di buku)</a></li>
  <li><a href="#function-file-lebih-sederhana" id="toc-function-file-lebih-sederhana" class="nav-link" data-scroll-target="#function-file-lebih-sederhana">Function file (lebih sederhana)</a></li>
  <li><a href="#contoh-linear-shooting" id="toc-contoh-linear-shooting" class="nav-link" data-scroll-target="#contoh-linear-shooting">Contoh Linear Shooting</a></li>
  </ul></li>
  <li><a href="#nonlinear-shooting" id="toc-nonlinear-shooting" class="nav-link" data-scroll-target="#nonlinear-shooting"><em>Nonlinear Shooting</em></a>
  <ul class="collapse">
  <li><a href="#bentuk-umum-ide-utama" id="toc-bentuk-umum-ide-utama" class="nav-link" data-scroll-target="#bentuk-umum-ide-utama">Bentuk umum, ide utama</a></li>
  <li><a href="#function-file-metode-secant" id="toc-function-file-metode-secant" class="nav-link" data-scroll-target="#function-file-metode-secant">Function file (metode secant)</a></li>
  <li><a href="#modifikasi-untuk-metode-newton" id="toc-modifikasi-untuk-metode-newton" class="nav-link" data-scroll-target="#modifikasi-untuk-metode-newton">Modifikasi untuk metode Newton</a></li>
  <li><a href="#function-file-dari-pseudocode" id="toc-function-file-dari-pseudocode" class="nav-link" data-scroll-target="#function-file-dari-pseudocode">Function file (dari pseudocode)</a></li>
  <li><a href="#function-file-metode-newton" id="toc-function-file-metode-newton" class="nav-link" data-scroll-target="#function-file-metode-newton">Function file (metode Newton)</a></li>
  <li><a href="#contoh-nonlinear-shooting" id="toc-contoh-nonlinear-shooting" class="nav-link" data-scroll-target="#contoh-nonlinear-shooting">Contoh Nonlinear Shooting</a></li>
  </ul></li>
  <li><a href="#linear-finite-difference" id="toc-linear-finite-difference" class="nav-link" data-scroll-target="#linear-finite-difference"><em>Linear Finite Difference</em></a>
  <ul class="collapse">
  <li><a href="#function-file-dari-pseudocode-1" id="toc-function-file-dari-pseudocode-1" class="nav-link" data-scroll-target="#function-file-dari-pseudocode-1">Function file (dari pseudocode)</a></li>
  <li><a href="#function-file-dengan-solusi-spl-secara-eksakinvers" id="toc-function-file-dengan-solusi-spl-secara-eksakinvers" class="nav-link" data-scroll-target="#function-file-dengan-solusi-spl-secara-eksakinvers">Function file (dengan solusi SPL secara eksak/invers)</a></li>
  <li><a href="#contoh-linear-finite-difference" id="toc-contoh-linear-finite-difference" class="nav-link" data-scroll-target="#contoh-linear-finite-difference">Contoh <em>Linear Finite Difference</em></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modul 6 Persamaan Diferensial Numerik: Metode <em>Shooting</em> dan <em>Linear Finite Difference</em> untuk Masalah Nilai Batas PDB</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Kembali ke <a href="../../../../../semuahalaman/modulprak/2024/genap/pdnum/pdnum2024genap.html">Persamaan Diferensial Numerik</a></p>
<p>Di modul ini, kita akan membahas beberapa metode untuk masalah nilai batas untuk PDB, yaitu:</p>
<ol type="1">
<li><em>Linear Shooting</em></li>
<li><em>Nonlinear Shotting</em></li>
<li><em>Linear Finite Difference</em></li>
</ol>
<section id="review-runge-kutta-orde-4-untuk-sistem" class="level2">
<h2 class="anchored" data-anchor-id="review-runge-kutta-orde-4-untuk-sistem">Review: Runge-Kutta orde 4 untuk sistem</h2>
<p><em>Shooting method</em> untuk masalah nilai batas melibatkan sistem persamaan diferensial. Kita akan menggunakan kode metode Runge-Kutta orde 4 untuk sistem dari modul sebelumnya:</p>
<div id="cell-6" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [t<span class="op">,</span> w] <span class="op">=</span> rko4_sysm(cell_f<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alphas)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  m <span class="op">=</span> <span class="fu">length</span>(cell_f)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> N<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  t <span class="op">=</span> <span class="fu">zeros</span>(N <span class="op">+</span> <span class="fl">1</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> <span class="fu">zeros</span>(m<span class="op">,</span> N <span class="op">+</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  t(<span class="fl">1</span>) <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  w(<span class="op">:,</span> <span class="fl">1</span>) <span class="op">=</span> alphas<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  k1 <span class="op">=</span> <span class="fu">zeros</span>(m<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  k2 <span class="op">=</span> <span class="fu">zeros</span>(m<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  k3 <span class="op">=</span> <span class="fu">zeros</span>(m<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  k4 <span class="op">=</span> <span class="fu">zeros</span>(m<span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> N</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    t(<span class="fu">i</span> <span class="op">+</span> <span class="fl">1</span>) <span class="op">=</span> t(<span class="fu">i</span>) <span class="op">+</span> h<span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>      k1(<span class="fu">j</span>) <span class="op">=</span> h <span class="op">*</span> cell_f{<span class="fu">j</span>}(t(<span class="fu">i</span>)<span class="op">,</span> w(<span class="op">:,</span> <span class="fu">i</span>))<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>      k2(<span class="fu">j</span>) <span class="op">=</span> h <span class="op">*</span> cell_f{<span class="fu">j</span>}(t(<span class="fu">i</span>) <span class="op">+</span> (h <span class="op">/</span> <span class="fl">2</span>)<span class="op">,</span> w(<span class="op">:,</span> <span class="fu">i</span>) <span class="op">+</span> (k1 <span class="op">/</span> <span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      k3(<span class="fu">j</span>) <span class="op">=</span> h <span class="op">*</span> cell_f{<span class="fu">j</span>}(t(<span class="fu">i</span>) <span class="op">+</span> (h <span class="op">/</span> <span class="fl">2</span>)<span class="op">,</span> w(<span class="op">:,</span> <span class="fu">i</span>) <span class="op">+</span> (k2 <span class="op">/</span> <span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      k4(<span class="fu">j</span>) <span class="op">=</span> h <span class="op">*</span> cell_f{<span class="fu">j</span>}(t(<span class="fu">i</span> <span class="op">+</span> <span class="fl">1</span>)<span class="op">,</span> w(<span class="op">:,</span> <span class="fu">i</span>) <span class="op">+</span> k3)<span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">j</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">:</span> m</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      w(<span class="fu">j</span><span class="op">,</span> <span class="fu">i</span> <span class="op">+</span> <span class="fl">1</span>) <span class="op">=</span> w(<span class="fu">j</span><span class="op">,</span> <span class="fu">i</span>) <span class="op">+</span> (k1(<span class="fu">j</span>) <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> k2(<span class="fu">j</span>) <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> k3(<span class="fu">j</span>) <span class="op">+</span> k4(<span class="fu">j</span>)) <span class="op">/</span> <span class="fl">6</span><span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sebenarnya tidak harus metode Runge-Kutta orde 4 untuk sistem. Boleh ditukar dengan metode lainnya untuk sistem, misalnya metode Adams predictor-corrector orde 4 untuk sistem.</p>
</section>
<section id="linear-shooting" class="level2">
<h2 class="anchored" data-anchor-id="linear-shooting"><em>Linear Shooting</em></h2>
<section id="bentuk-umum-ide-utama-penyederhanaan" class="level3">
<h3 class="anchored" data-anchor-id="bentuk-umum-ide-utama-penyederhanaan">Bentuk umum, ide utama, penyederhanaan</h3>
<p>Linear Shooting merupakan metode untuk menyelesaikan sejenis masalah nilai batas untuk PDB, yaitu yang berbentuk:</p>
<p><span class="math inline">\(y'' = f\left(x,y,y'\right) = p(x)y' + q(x)y + r(x), \;a\leq x\leq b\)</span></p>
<p><span class="math inline">\(y(a)=\alpha, \;y(b)=\beta\)</span></p>
<p>dengan</p>
<ul>
<li><span class="math inline">\(p(x), q(x), r(x)\)</span> adalah fungsi kontinu dalam <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(q(x) &gt; 0\)</span> pada <span class="math inline">\([a,b]\)</span> agar dijamin ada solusi unik</li>
</ul>
<p>Cara penyelesaiannya:</p>
<ol type="1">
<li>Selesaikan MNA PDB orde 2 berikut, solusinya disebut <span class="math inline">\(y_1 \left(x\right)\)</span>:</li>
</ol>
<p><span class="math display">\[y'' = p(x)y' + q(x)y + r(x), \quad a \le x \le b, \quad y\left(a\right) = \alpha, \quad y'\left(a\right) = 0\]</span></p>
<ol start="2" type="1">
<li>Selesaikan MNA PDB orde 2 berikut, solusinya disebut <span class="math inline">\(y_2 \left(x\right)\)</span></li>
</ol>
<p><span class="math display">\[y'' = p(x)y' + q(x)y, \quad a \le x \le b, \quad y\left(a\right) = 0, \quad y'\left(a\right) = 1\]</span></p>
<ol start="3" type="1">
<li>Solusi akhirnya adalah</li>
</ol>
<p><span class="math display">\[y\left(x\right) = y_1 \left(x\right) + \frac{\beta - y_1 \left(b\right)}{y_2 \left(b\right)} y_2 \left(x\right)\]</span></p>
<p>Kita bisa menuliskan kedua MNA PDB orde 2 tersebut masing-masing sebagai sistem PDB orde 1, seperti biasa dengan permisalan <span class="math inline">\(u_1(x) = y(x)\)</span> dan <span class="math inline">\(u_2(x) = y'(x)\)</span>.</p>
<p>Sehingga, langkahnya menjadi:</p>
<ol type="1">
<li>Selesaikan sistem PDB orde 1 berikut. Kemudian solusi <span class="math inline">\(u_1(x)\)</span> disebut <span class="math inline">\(y_1(x)\)</span> dan solusi <span class="math inline">\(u_2(x)\)</span> disebut <span class="math inline">\(y_1'(x)\)</span>.</li>
</ol>
<span class="math display">\[\begin{aligned}
u_1'(x) &amp;= u_2(x) \\
u_2'(x) &amp;= p(x) u_2(x) + q(x) u_1(x) + r(x) \\
u_1 (a) &amp;= \alpha, \quad u_2 (a) = 0
\end{aligned}\]</span>
<ol start="2" type="1">
<li>Selesaikan sistem PDB orde 1 berikut. Kemudian solusi <span class="math inline">\(u_1(x)\)</span> disebut <span class="math inline">\(y_2(x)\)</span> dan solusi <span class="math inline">\(u_2(x)\)</span> disebut <span class="math inline">\(y_2'(x)\)</span>.</li>
</ol>
<span class="math display">\[\begin{aligned}
u_1'(x) &amp;= u_2(x) \\
u_2'(x) &amp;= p(x)u_2(x) + q(x)u_1(x) \\
u_1 (a) &amp;= 0, \quad u_2(a) = 1
\end{aligned}\]</span>
<ol start="3" type="1">
<li>Solusi akhirnya adalah</li>
</ol>
<p><span class="math display">\[y(x) = y_1(x) + \frac{\beta - y_1(b)}{y_2(b)} y_2(x)\]</span></p>
<p>Kalau perlu,</p>
<p><span class="math display">\[y'(x) = y_1'(x) + \frac{\beta - y_1(b)}{y_2(b)} y_2'(x)\]</span></p>
</section>
<section id="function-file-dari-pseudocode-di-buku" class="level3">
<h3 class="anchored" data-anchor-id="function-file-dari-pseudocode-di-buku">Function file (dari pseudocode di buku)</h3>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x_i<span class="op">,</span> w_1i<span class="op">,</span> w_2i] <span class="op">=</span> linshoot_pseudocode(p<span class="op">,</span> q<span class="op">,</span> r<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> n<span class="op">,</span> alpha<span class="op">,</span> <span class="fu">beta</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  h <span class="op">=</span> (b <span class="op">-</span> a)<span class="op">/</span>n<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  u <span class="op">=</span> [alpha <span class="op">;</span> <span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  v <span class="op">=</span> [<span class="fl">0</span> <span class="op">;</span> <span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  x_i <span class="op">=</span> w_1i <span class="op">=</span> w_2i <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> a <span class="op">+</span> (<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>h<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    k_11 <span class="op">=</span> h <span class="op">*</span> u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    k_12 <span class="op">=</span> h <span class="op">*</span> (p(x)<span class="op">*</span>u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> q(x)<span class="op">*</span>u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> r(x))<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    k_21 <span class="op">=</span> h <span class="op">*</span> (u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_12<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    k_22 <span class="op">=</span> h <span class="op">*</span> (p(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_12<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> q(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_11<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> r(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    k_31 <span class="op">=</span> h <span class="op">*</span> (u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_22<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    k_32 <span class="op">=</span> h <span class="op">*</span> (p(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_22<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> q(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_21<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> r(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    k_41 <span class="op">=</span> h <span class="op">*</span> (u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>k_32)<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    k_42 <span class="op">=</span> h <span class="op">*</span> (p(x<span class="op">+</span>h)<span class="op">*</span>(u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>k_32) <span class="op">+</span> q(x<span class="op">+</span>h)<span class="op">*</span>(u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>k_31) <span class="op">+</span> r(x<span class="op">+</span>h))<span class="op">;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> ((k_11 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_21 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_31 <span class="op">+</span> k_41)<span class="op">/</span><span class="fl">6</span>)<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> ((k_12 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_22 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_32 <span class="op">+</span> k_42)<span class="op">/</span><span class="fl">6</span>)<span class="op">;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    kp_11 <span class="op">=</span> h <span class="op">*</span> v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    kp_12 <span class="op">=</span> h <span class="op">*</span> (p(x)<span class="op">*</span>v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> q(x)<span class="op">*</span>v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>))<span class="op">;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    kp_21 <span class="op">=</span> h <span class="op">*</span> (v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> (kp_12<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    kp_22 <span class="op">=</span> h <span class="op">*</span> (p(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(kp_12<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> q(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(kp_11<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    kp_31 <span class="op">=</span> h <span class="op">*</span> (v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(kp_22<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    kp_32 <span class="op">=</span> h <span class="op">*</span> (p(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(kp_22<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> q(x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">*</span>(v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(kp_21<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    kp_41 <span class="op">=</span> h <span class="op">*</span> (v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>kp_32)<span class="op">;</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    kp_42 <span class="op">=</span> h <span class="op">*</span> (p(x<span class="op">+</span>h)<span class="op">*</span>(v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>kp_32) <span class="op">+</span> q(x<span class="op">+</span>h)<span class="op">*</span>(v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>kp_31))<span class="op">;</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> (kp_11 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_21 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_31 <span class="op">+</span> kp_41)<span class="op">/</span><span class="fl">6</span><span class="op">;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> (kp_12 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_22 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_32 <span class="op">+</span> kp_42)<span class="op">/</span><span class="fl">6</span><span class="op">;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> [alpha <span class="op">;</span> ((<span class="fu">beta</span> <span class="op">-</span> u(<span class="fl">1</span><span class="op">,</span>(n<span class="op">+</span><span class="fl">1</span>))) <span class="op">/</span> v(<span class="fl">1</span><span class="op">,</span>(n<span class="op">+</span><span class="fl">1</span>)))]<span class="op">;</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  x_i(<span class="fl">1</span>) <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  w_1i(<span class="fl">1</span>) <span class="op">=</span> w(<span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  w_2i(<span class="fl">1</span>) <span class="op">=</span> w(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span><span class="op">:</span>(n<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    W1 <span class="op">=</span> u(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> w(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)<span class="op">*</span>v(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    W2 <span class="op">=</span> u(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> w(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)<span class="op">*</span>v(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> a <span class="op">+</span> (<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>h<span class="op">;</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    x_i(<span class="fu">i</span>) <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    w_1i(<span class="fu">i</span>) <span class="op">=</span> W1<span class="op">;</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    w_2i(<span class="fu">i</span>) <span class="op">=</span> W2<span class="op">;</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-file-lebih-sederhana" class="level3">
<h3 class="anchored" data-anchor-id="function-file-lebih-sederhana">Function file (lebih sederhana)</h3>
<div id="cell-18" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x<span class="op">,</span> w1<span class="op">,</span> w2] <span class="op">=</span> linear_shooting(p<span class="op">,</span> q<span class="op">,</span> r<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">% sistem PDB yang pertama</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  u1_aksen <span class="op">=</span> @(x<span class="op">,</span> u) u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  u2_aksen <span class="op">=</span> @(x<span class="op">,</span> u) p(x)<span class="op">*</span>u(<span class="fl">2</span>) <span class="op">+</span> q(x)<span class="op">*</span>u(<span class="fl">1</span>) <span class="op">+</span> r(x)<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  [x<span class="op">,</span> w_pers1] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [alph<span class="op">,</span> <span class="fl">0</span>])<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  y1_b <span class="op">=</span> w_pers1(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">% sistem PDB yang kedua</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  u1_aksen <span class="op">=</span> @(x<span class="op">,</span> u) u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  u2_aksen <span class="op">=</span> @(x<span class="op">,</span> u) p(x)<span class="op">*</span>u(<span class="fl">2</span>) <span class="op">+</span> q(x)<span class="op">*</span>u(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  [x<span class="op">,</span> w_pers2] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [<span class="fl">0</span><span class="op">,</span> <span class="fl">1</span>])<span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  y2_b <span class="op">=</span> w_pers2(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">% solusi akhir (superposisi)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  w_akhir <span class="op">=</span> w_pers1 <span class="op">+</span> (bet <span class="op">-</span> y1_b)<span class="op">/</span>(y2_b) <span class="op">*</span> w_pers2<span class="op">;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">% dipisah jadi w1i (aproksimasi y(x)) dan w2i (aproksimasi y'(x))</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  w1 <span class="op">=</span> w_akhir(<span class="fl">1</span><span class="op">,</span> <span class="op">:</span>)<span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  w2 <span class="op">=</span> w_akhir(<span class="fl">2</span><span class="op">,</span> <span class="op">:</span>)<span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contoh-linear-shooting" class="level3">
<h3 class="anchored" data-anchor-id="contoh-linear-shooting">Contoh Linear Shooting</h3>
<p><span class="math inline">\(y'' = -\frac{2}{x}y' + \frac{2}{x^2}y + \frac{\sin(\ln(x))}{x^2}, \; 1\leq x\leq 2\)</span></p>
<p><span class="math inline">\(y(1)=1,\; y(2)=2\)</span></p>
<p>dengan <span class="math inline">\(N=10\)</span></p>
<p>dan solusi eksak:</p>
<p><span class="math inline">\(y=c_1x+\frac{c_2}{x^2} - \frac{3}{10}\sin(\ln(x))-\frac{1}{10}cos(\ln(x))\)</span></p>
<p><span class="math inline">\(c_2 = \frac{1}{70}(8-12\sin(\ln(2)) - 4\cos(\ln(2)))\)</span></p>
<p><span class="math inline">\(c_1 = \frac{11}{10}-c_2\)</span></p>
<p>Berikut code script file untuk permasalahan di atas menggunakan metode linear shooting:</p>
<div id="cell-21" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> @(x) (<span class="op">-</span><span class="fl">2</span> <span class="op">./</span> x)<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> @(x) (<span class="fl">2</span> <span class="op">./</span> (x <span class="op">.^</span> <span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> @(x) (<span class="fu">sin</span>(<span class="fu">log</span>(x))<span class="op">*</span>(x <span class="op">.^</span> (<span class="op">-</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span><span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>alph <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>bet <span class="op">=</span> <span class="fl">2</span><span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>[xi<span class="op">,</span> w1i<span class="op">,</span> w2i] <span class="op">=</span> linear_shooting(p<span class="op">,</span> q<span class="op">,</span> r<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">% solusi eksak</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>c2 <span class="op">=</span> (<span class="fl">8</span><span class="op">-</span><span class="fl">12</span><span class="op">*</span><span class="fu">sin</span>(<span class="fu">log</span>(<span class="fl">2</span>)) <span class="op">-</span> <span class="fl">4</span><span class="op">*</span><span class="fu">cos</span>(<span class="fu">log</span>(<span class="fl">2</span>)))<span class="op">/</span><span class="fl">70</span><span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>c1 <span class="op">=</span> (<span class="fl">11</span><span class="op">/</span><span class="fl">10</span>) <span class="op">-</span> c2<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x) (c1<span class="op">*</span>x <span class="op">+</span> (c2<span class="op">*</span>x<span class="op">.^</span>(<span class="op">-</span><span class="fl">2</span>)) <span class="op">-</span> (<span class="fl">3</span><span class="op">/</span><span class="fl">10</span>)<span class="op">*</span><span class="fu">sin</span>(<span class="fu">log</span>(x)) <span class="op">-</span> (<span class="fl">1</span><span class="op">/</span><span class="fl">10</span>)<span class="op">*</span><span class="fu">cos</span>(<span class="fu">log</span>(x)))<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>y_eksak <span class="op">=</span> sln(xi)<span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">% tampilkan </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>[xi<span class="op">,</span> w1i<span class="op">',</span> y_eksak]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">hold</span> on<span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">fplot</span>(sln<span class="op">,</span> [a<span class="op">,</span>b]<span class="op">,</span> <span class="st">'k'</span>)<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(xi<span class="op">,</span> w1i<span class="op">,</span> <span class="st">'-r'</span>)<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'Eksak'</span><span class="op">,</span> <span class="st">'Aproksimasi'</span>)<span class="op">;</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'location'</span><span class="op">,</span> <span class="st">'northwest'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans =

   1.0000   1.0000   1.0000
   1.1000   1.0926   1.0926
   1.2000   1.1871   1.1871
   1.3000   1.2834   1.2834
   1.4000   1.3814   1.3814
   1.5000   1.4812   1.4812
   1.6000   1.5824   1.5824
   1.7000   1.6850   1.6850
   1.8000   1.7889   1.7889
   1.9000   1.8939   1.8939
   2.0000   2.0000   2.0000
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul6_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Jika kita run script file tersebut, maka program akan mengeluarkan dua macam output, yaitu tabel serta plot perbandingan solusi eksak dan aproksimasi seperti di bawah ini:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="attachment:image.png" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="attachment:image-2.png" class="img-fluid figure-img"></p>
<figcaption>image-2.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="nonlinear-shooting" class="level2">
<h2 class="anchored" data-anchor-id="nonlinear-shooting"><em>Nonlinear Shooting</em></h2>
<section id="bentuk-umum-ide-utama" class="level3">
<h3 class="anchored" data-anchor-id="bentuk-umum-ide-utama">Bentuk umum, ide utama</h3>
<p>Nonlinear Shooting digunakan untuk menyelesaikan masalah PD berbentuk:</p>
<p><span class="math inline">\(y'' = f(x, y, y'), \; a\leq x \leq b\)</span></p>
<p><span class="math inline">\(y(a)=\alpha, \; y(b)=\beta\)</span></p>
<p>dengan <span class="math inline">\(f\)</span> boleh berupa fungsi linier maupun nonlinier</p>
<p>Cara penyelesaiannya:</p>
<ol type="1">
<li>Tentukan toleransi <span class="math inline">\(\varepsilon\)</span>, dan pilih tebakan awal <span class="math inline">\(t_0\)</span> (yaitu <span class="math inline">\(t_k\)</span> sebelum iterasi pertama, yaitu dengan <span class="math inline">\(k=0\)</span>). Kalau bingung, disarankan</li>
</ol>
<p><span class="math display">\[t_0 = \frac{\beta - \alpha}{b-a}\]</span></p>
<ol start="2" type="1">
<li>Selesaikan MNA PDB orde 2 berikut, misalkan solusinya disebut <span class="math inline">\(w(x,t_k)\)</span>:</li>
</ol>
<p><span class="math display">\[y'' = f(x,y,y'), \quad a \le x \le b, \quad y(a) = \alpha, \quad y'(a) = t_k\]</span></p>
<ol start="3" type="1">
<li><p>Periksa apakah <span class="math inline">\(\left|w(x,t_k) - \beta\right| \le \varepsilon\)</span>.</p>
<ul>
<li>Kalau iya, selesai; solusi akhirnya adalah <span class="math inline">\(y(x) = w(x,t_k)\)</span>.</li>
<li>Kalau tidak, peroleh tebakan baru untuk <span class="math inline">\(t_i\)</span> (misalnya dengan metode secant atau metode Newton), lalu kembali ke langkah 2.</li>
</ul></li>
</ol>
<p>Seperti biasa, kita bisa misalkan <span class="math inline">\(u_1(x) = y(x)\)</span> dan <span class="math inline">\(u_2(x) = y'(x)\)</span> agar MNA PDB orde 2 menjadi sistem PDB orde 1.</p>
<p>Cara penyelesaiannya menjadi:</p>
<ol type="1">
<li>Tentukan toleransi <span class="math inline">\(\varepsilon\)</span>, dan pilih tebakan awal <span class="math inline">\(t_0\)</span> (yaitu <span class="math inline">\(t_k\)</span> sebelum iterasi pertama, yaitu dengan <span class="math inline">\(k=0\)</span>). Kalau bingung, disarankan</li>
</ol>
<p><span class="math display">\[t_0 = \frac{\beta - \alpha}{b-a}\]</span></p>
<ol start="2" type="1">
<li>Selesaikan sistem PDB orde 1 berikut. Kemudian <span class="math inline">\(u_1(x)\)</span> disebut <span class="math inline">\(w(x,t_k)\)</span> dan <span class="math inline">\(u_2(x)\)</span> disebut <span class="math inline">\(w'(x,t_k)\)</span>.</li>
</ol>
<span class="math display">\[\begin{aligned}
u_1'(x) &amp;= u_2(x) \\
u_2'(x) &amp;= f(x,u_1,u_2) \\
y(a) &amp;= \alpha, \quad y'(a) = t_k
\end{aligned}\]</span>
<ol start="3" type="1">
<li><p>Periksa apakah <span class="math inline">\(\left|w(x,t_k) - \beta\right| \le \varepsilon\)</span>.</p>
<ul>
<li>Kalau iya, selesai; solusi akhirnya adalah <span class="math inline">\(y(x) = w(x,t_k)\)</span>.</li>
<li>Kalau tidak, peroleh tebakan baru untuk <span class="math inline">\(t_k\)</span> (misalnya dengan metode secant atau metode Newton), lalu kembali ke langkah 2.</li>
</ul></li>
</ol>
</section>
<section id="function-file-metode-secant" class="level3">
<h3 class="anchored" data-anchor-id="function-file-metode-secant">Function file (metode secant)</h3>
<div id="cell-30" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x<span class="op">,</span> w1<span class="op">,</span> w2] <span class="op">=</span> nonlinear_shooting_secant(f<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> t0<span class="op">,</span> t1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  u1_aksen <span class="op">=</span> @(x<span class="op">,</span> u) u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  u2_aksen <span class="op">=</span> @(x<span class="op">,</span> u) f(x<span class="op">,</span> u(<span class="fl">1</span>)<span class="op">,</span> u(<span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  t_k_min_2 <span class="op">=</span> t0<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  t_k_min_1 <span class="op">=</span> t1<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  [x<span class="op">,</span> w_k_min_2] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [alph<span class="op">,</span> t_k_min_2])<span class="op">;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  [x<span class="op">,</span> w_k_min_1] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [alph<span class="op">,</span> t_k_min_1])<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  w_k <span class="op">=</span> w_k_min_1<span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  err <span class="op">=</span> <span class="fu">abs</span>(w_k(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> bet)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">!</span>(err <span class="op">&lt;=</span> tol)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    pembilang <span class="op">=</span> (w_k_min_1(<span class="fl">1</span><span class="op">,</span>N<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> bet) <span class="op">*</span> (t_k_min_1 <span class="op">-</span> t_k_min_2)<span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    penyebut <span class="op">=</span> w_k_min_1(<span class="fl">1</span><span class="op">,</span>N<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> w_k_min_2(<span class="fl">1</span><span class="op">,</span>N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    t_k <span class="op">=</span> t_k_min_1 <span class="op">-</span> pembilang<span class="op">/</span>penyebut<span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    t_k_min_2 <span class="op">=</span> t_k_min_1</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    t_k_min_1 <span class="op">=</span> t_k</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    [x<span class="op">,</span> w_k] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [alph<span class="op">,</span> t_k])<span class="op">;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    err <span class="op">=</span> <span class="fu">abs</span>(w_k(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> bet)<span class="op">;</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endwhile</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">% keluar loop artinya toleransi sudah terpenuhi</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">% memisahkan w_k menjadi w1i dan w2i</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  w1 <span class="op">=</span> w_k(<span class="fl">1</span><span class="op">,</span> <span class="op">:</span>)<span class="op">;</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  w2 <span class="op">=</span> w_k(<span class="fl">2</span><span class="op">,</span> <span class="op">:</span>)<span class="op">;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modifikasi-untuk-metode-newton" class="level3">
<h3 class="anchored" data-anchor-id="modifikasi-untuk-metode-newton">Modifikasi untuk metode Newton</h3>
<p>Untuk menggunakan metode Newton, diperlukan tidak hanya <span class="math inline">\(y(b,t)\)</span> tetapi juga turunannya <span class="math inline">\(\frac{\partial y(b,t)}{\partial t}\)</span> yang sayangnya tidak dimiliki.</p>
<p>Setelah penjabaran yang panjang di buku, ternyata bisa dimisalkan</p>
<p><span class="math display">\[z(x,t) = \frac{\partial y(x,t)}{\partial t}\]</span></p>
<p>dan nilai fungsi <span class="math inline">\(z\)</span> ini ternyata bisa diperoleh dengan menyelesaikan suatu MNA PDB orde 2 (lagi). Sehingga, di tiap iterasi, ada dua MNA PDB orde 2 yang harus diselesaikan.</p>
<p>Langkah <em>nonlinear shooting</em> dengan metode Newton bisa ditulis:</p>
<ol type="1">
<li><p>Hitung rumus <span class="math inline">\(\frac{\partial f}{\partial y}(x,y,y')\)</span> dan rumus <span class="math inline">\(\frac{\partial f}{\partial y'}(x,y,y')\)</span> secara analitik.</p></li>
<li><p>Tentukan toleransi <span class="math inline">\(\varepsilon\)</span>, dan pilih tebakan awal <span class="math inline">\(t_0\)</span> (yaitu <span class="math inline">\(t_k\)</span> sebelum iterasi pertama, yaitu dengan <span class="math inline">\(k=0\)</span>). Kalau bingung, disarankan</p></li>
</ol>
<p><span class="math display">\[t_0 = \frac{\beta - \alpha}{b-a}\]</span></p>
<ol start="3" type="1">
<li>Selesaikan MNA PDB orde 2 berikut, misalkan solusinya disebut <span class="math inline">\(w(x,t_k)\)</span>:</li>
</ol>
<p><span class="math display">\[y'' = f(x,y,y'), \quad a \le x \le b, \quad y(a) = \alpha, \quad y'(a) = t_k\]</span></p>
<ol start="4" type="1">
<li>Selesaikan MNA PDB orde 2 berikut:</li>
</ol>
<p><span class="math display">\[z'' = \frac{\partial f}{\partial y}(x,y,y')z(x) + \frac{\partial f}{\partial y'}(x,y,y')z'(x), \quad z(a) = 0, \quad z'(a) = 1\]</span></p>
<ol start="5" type="1">
<li><p>Periksa apakah <span class="math inline">\(\left|w(x,t_k) - \beta\right| \le \varepsilon\)</span>.</p>
<ul>
<li>Kalau iya, selesai; solusi akhirnya adalah <span class="math inline">\(y(x) = w(x,t_k)\)</span>.</li>
<li>Kalau tidak, kembali ke langkah 3 setelah memperoleh tebakan baru untuk <span class="math inline">\(t_k\)</span>: <span class="math display">\[t_k = t_{k-1} - \frac{w(b, t_{k-1}) - \beta}{z(b, t_{k-1})}\]</span></li>
</ul></li>
</ol>
<p>Dengan permisalan <span class="math inline">\(u_1\)</span> dan <span class="math inline">\(u_2\)</span> agar PDB orde 2 menjadi sistem PDB orde 1, langkah-langkahnya menjadi:</p>
<ol type="1">
<li><p>Hitung rumus <span class="math inline">\(\frac{\partial f}{\partial y}(x,y,y')\)</span> dan rumus <span class="math inline">\(\frac{\partial f}{\partial y'}(x,y,y')\)</span> secara analitik.</p></li>
<li><p>Tentukan toleransi <span class="math inline">\(\varepsilon\)</span>, dan pilih tebakan awal <span class="math inline">\(t_0\)</span> (yaitu <span class="math inline">\(t_k\)</span> sebelum iterasi pertama, yaitu dengan <span class="math inline">\(k=0\)</span>). Kalau bingung, disarankan</p></li>
</ol>
<p><span class="math display">\[t_0 = \frac{\beta - \alpha}{b-a}\]</span></p>
<ol start="3" type="1">
<li>Selesaikan sistem PDB orde 1 berikut. Kemudian <span class="math inline">\(u_1(x)\)</span> disebut <span class="math inline">\(w(x,t_k)\)</span> dan <span class="math inline">\(u_2(x)\)</span> disebut <span class="math inline">\(w'(x,t_k)\)</span>.</li>
</ol>
<span class="math display">\[\begin{aligned}
u_1'(x) &amp;= u_2(x) \\
u_2'(x) &amp;= f(x,u_1,u_2) \\
y(a) &amp;= \alpha, \quad y'(a) = t_k
\end{aligned}\]</span>
<ol start="4" type="1">
<li>Selesaikan sistem PDB orde 1 berikut. Kemudian <span class="math inline">\(u_1(x)\)</span> disebut <span class="math inline">\(z(x,t_k)\)</span> dan <span class="math inline">\(u_2(x)\)</span> disebut <span class="math inline">\(z'(x,t_k)\)</span>.</li>
</ol>
<span class="math display">\[\begin{aligned}
u_1'(x) &amp;= u_2(x) \\
u_2'(x) &amp;= \frac{\partial f}{\partial y}(x,u_1,u_2)u_1(x) + \frac{\partial f}{\partial y'}(x,u_1,u_2)u_2(x) \\
u_1(a) &amp;= 0, \quad u_2(a) = 1
\end{aligned}\]</span>
<ol start="5" type="1">
<li><p>Periksa apakah <span class="math inline">\(\left|w(x,t_k) - \beta\right| \le \varepsilon\)</span>.</p>
<ul>
<li>Kalau iya, selesai; solusi akhirnya adalah <span class="math inline">\(y(x) = w(x,t_k)\)</span>.</li>
<li>Kalau tidak, kembali ke langkah 3 setelah memperoleh tebakan baru untuk <span class="math inline">\(t_k\)</span>: <span class="math display">\[t_k = t_{k-1} - \frac{w(b, t_{k-1}) - \beta}{z(b, t_{k-1})}\]</span></li>
</ul></li>
</ol>
</section>
<section id="function-file-dari-pseudocode" class="level3">
<h3 class="anchored" data-anchor-id="function-file-dari-pseudocode">Function file (dari pseudocode)</h3>
<div id="cell-38" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x_i<span class="op">,</span> w_1i<span class="op">,</span> w_2i] <span class="op">=</span> nonlinshoot_pseudocode(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> n<span class="op">,</span> alpha<span class="op">,</span> <span class="fu">beta</span><span class="op">,</span> m<span class="op">,</span> tol)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">% m adalah maksimum iterasi</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  h <span class="op">=</span> (b <span class="op">-</span> a)<span class="op">/</span>n<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  k <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  tk <span class="op">=</span> (<span class="fu">beta</span> <span class="op">-</span> alpha)<span class="op">/</span>(b <span class="op">-</span> a)<span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  x_i <span class="op">=</span> w_1i <span class="op">=</span> w_2i <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> k <span class="op">&lt;=</span> m</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> [alpha<span class="op">;</span>tk]<span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> [<span class="fl">0</span><span class="op">,</span><span class="fl">1</span>]<span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      x <span class="op">=</span> a <span class="op">+</span> (<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>h<span class="op">;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      k_11 <span class="op">=</span> h<span class="op">*</span>w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      k_12 <span class="op">=</span> h<span class="op">*</span>f(x<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      k_21 <span class="op">=</span> h<span class="op">*</span>(w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_12<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      k_22 <span class="op">=</span> h<span class="op">*</span>f((x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> (w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_11<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> (w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_12<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      k_31 <span class="op">=</span> h<span class="op">*</span>(w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_22<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>      k_32 <span class="op">=</span> h<span class="op">*</span>f((x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> (w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_21<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> (w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>(k_22<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>      k_41 <span class="op">=</span> h<span class="op">*</span>(w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>k_32)<span class="op">;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      k_42 <span class="op">=</span> h<span class="op">*</span>f((x<span class="op">+</span>h)<span class="op">,</span> (w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>k_31)<span class="op">,</span> (w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">+</span>k_32))<span class="op">;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> ((k_11 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_21 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_31 <span class="op">+</span> k_41)<span class="op">/</span><span class="fl">6</span>)<span class="op">;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">=</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>) <span class="op">+</span> ((k_12 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_22 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>k_32 <span class="op">+</span> k_42)<span class="op">/</span><span class="fl">6</span>)<span class="op">;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      kp_11 <span class="op">=</span> h<span class="op">*</span>u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      kp_12 <span class="op">=</span> h<span class="op">*</span>(fy(x<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>u(<span class="fl">1</span>) <span class="op">+</span> fyp(x<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>u(<span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>      kp_21 <span class="op">=</span> h<span class="op">*</span>(u(<span class="fl">2</span>) <span class="op">+</span> (kp_12<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>      kp_22 <span class="op">=</span> h<span class="op">*</span>(fy((x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>u(<span class="fl">1</span>) <span class="op">+</span> fyp((x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>(u(<span class="fl">2</span>) <span class="op">+</span> (kp_12<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>      kp_31 <span class="op">=</span> h<span class="op">*</span>(u(<span class="fl">2</span>)<span class="op">+</span>(kp_22<span class="op">/</span><span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>      kp_32 <span class="op">=</span> h<span class="op">*</span>(fy((x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>(u(<span class="fl">1</span>) <span class="op">+</span> (kp_21<span class="op">/</span><span class="fl">2</span>)) <span class="op">+</span> fyp((x<span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>))<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>(u(<span class="fl">2</span>) <span class="op">+</span> (kp_22<span class="op">/</span><span class="fl">2</span>)))<span class="op">;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      kp_41 <span class="op">=</span> h<span class="op">*</span>(u(<span class="fl">2</span>)<span class="op">+</span>kp_32)<span class="op">;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>      kp_42 <span class="op">=</span> h<span class="op">*</span>(fy((x<span class="op">+</span>h)<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>(u(<span class="fl">1</span>)<span class="op">+</span>kp_31) <span class="op">+</span> fyp((x<span class="op">+</span>h)<span class="op">,</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">,</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>))<span class="op">*</span>(u(<span class="fl">2</span>) <span class="op">+</span> kp_32))<span class="op">;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>      u(<span class="fl">1</span>) <span class="op">=</span> u(<span class="fl">1</span>) <span class="op">+</span> (kp_11 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_21 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_31 <span class="op">+</span> kp_41)<span class="op">/</span><span class="fl">6</span><span class="op">;</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>      u(<span class="fl">2</span>) <span class="op">=</span> u(<span class="fl">2</span>) <span class="op">+</span> (kp_12 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_22 <span class="op">+</span> <span class="fl">2</span><span class="op">*</span>kp_32 <span class="op">+</span> kp_42)<span class="op">/</span><span class="fl">6</span><span class="op">;</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="fu">abs</span>(w(<span class="fl">1</span><span class="op">,</span>n<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> <span class="fu">beta</span>) <span class="op">&lt;=</span> tol       <span class="co">% jika sudah mencapai batas toleransi maka program berhenti</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>(n<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>      x <span class="op">=</span> a<span class="op">+</span>(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>h<span class="op">;</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>      x_i(<span class="fu">i</span>) <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>      w_1i(<span class="fu">i</span>) <span class="op">=</span> w(<span class="fl">1</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>      w_2i(<span class="fu">i</span>) <span class="op">=</span> w(<span class="fl">2</span><span class="op">,</span><span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endfor</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endif</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  tk <span class="op">=</span> tk<span class="op">-</span>((w(<span class="fl">1</span><span class="op">,</span>n<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> <span class="fu">beta</span>)<span class="op">/</span>u(<span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  k <span class="op">=</span> k <span class="op">+</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endwhile</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">disp</span>(<span class="st">'max iteration'</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-file-metode-newton" class="level3">
<h3 class="anchored" data-anchor-id="function-file-metode-newton">Function file (metode Newton)</h3>
<div id="cell-40" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x<span class="op">,</span> w1<span class="op">,</span> w2] <span class="op">=</span> nonlinear_shooting_newton(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> t0)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">% kalau input t0 bukan angka, dianggap tidak memilih tebakan awal</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="fu">isnumeric</span>(t0)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    t_k <span class="op">=</span> t0<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    t_k <span class="op">=</span> (bet<span class="op">-</span>alph)<span class="op">/</span>(b<span class="op">-</span>a)<span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endif</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  err <span class="op">=</span> tol <span class="op">+</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">!</span>(err <span class="op">&lt;=</span> tol)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">% selesaikan sistem pertama</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    u1_aksen <span class="op">=</span> @(x<span class="op">,</span> u) u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    u2_aksen <span class="op">=</span> @(x<span class="op">,</span> u) f(x<span class="op">,</span> u(<span class="fl">1</span>)<span class="op">,</span> u(<span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    [x<span class="op">,</span> w_sys] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [alph<span class="op">,</span> t_k])<span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">% selesaikan sistem kedua</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    u1_aksen <span class="op">=</span> @(x<span class="op">,</span> u) u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    u2_aksen <span class="op">=</span> @(x<span class="op">,</span> u) fy(x<span class="op">,</span> u(<span class="fl">1</span>)<span class="op">,</span> u(<span class="fl">2</span>))<span class="op">*</span>u(<span class="fl">1</span>) <span class="op">+</span> fyp(x<span class="op">,</span> u(<span class="fl">1</span>)<span class="op">,</span> u(<span class="fl">2</span>))<span class="op">*</span>u(<span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    [x<span class="op">,</span> z_sys] <span class="op">=</span> rko4_sysm({u1_aksen<span class="op">,</span> u2_aksen}<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> [<span class="fl">0</span><span class="op">,</span> <span class="fl">1</span>])<span class="op">;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">% periksa toleransi, update t_k</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    err <span class="op">=</span> <span class="fu">abs</span>(w_sys(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> bet)<span class="op">;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">!</span>(err <span class="op">&lt;=</span> tol)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>      t_k <span class="op">=</span> t_k <span class="op">-</span> (w_sys(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>) <span class="op">-</span> bet)<span class="op">/</span>(z_sys(<span class="fl">1</span><span class="op">,</span> N<span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">endif</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endwhile</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">% keluar loop artinya toleransi sudah terpenuhi</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">% pisahkan w_sys menjadi w1i dan w2i</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  w1 <span class="op">=</span> w_sys(<span class="fl">1</span><span class="op">,</span> <span class="op">:</span>)<span class="op">;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  w2 <span class="op">=</span> w_sys(<span class="fl">2</span><span class="op">,</span> <span class="op">:</span>)<span class="op">;</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contoh-nonlinear-shooting" class="level3">
<h3 class="anchored" data-anchor-id="contoh-nonlinear-shooting">Contoh Nonlinear Shooting</h3>
<p><span class="math inline">\(y'' = \frac{1}{8}(32+2x^3-yy'), \; 1\leq x \leq 3\)</span></p>
<p><span class="math inline">\(y(1) = 17, \; y(3)=43/3\)</span></p>
<p>dengan <span class="math inline">\(N=20\)</span> dan toleransi <span class="math inline">\(=10^{-5}\)</span></p>
<p>dan solusi eksak:</p>
<p><span class="math inline">\(y(x)=x^2 + \frac{16}{x}\)</span></p>
<p>Hint:</p>
<span class="math display">\[\begin{aligned}
f(x,y,y') &amp;= \frac{1}{8}(32+2x^3-yy') \\
\frac{\partial f}{\partial y}(x,y,y') &amp;= -\frac{1}{8}y' \\
\frac{\partial f}{\partial y'}(x,y,y') &amp;= -\frac{1}{8}y
\end{aligned}\]</span>
<p>Berikut code script file untuk permasalahan di atas menggunakan metode linear shooting:</p>
<div id="cell-45" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> @(x<span class="op">,</span> y<span class="op">,</span> yp) ((<span class="fl">1</span><span class="op">/</span><span class="fl">8</span>)<span class="op">*</span>(<span class="fl">32</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> x<span class="op">.^</span><span class="fl">3</span> <span class="op">-</span> y <span class="op">.*</span> yp))<span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fy <span class="op">=</span> @(x<span class="op">,</span> y<span class="op">,</span> yp) (<span class="op">-</span>yp<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fyp <span class="op">=</span> @(x<span class="op">,</span> y<span class="op">,</span> yp) (<span class="op">-</span>y<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">3</span><span class="op">;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">20</span><span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>alph <span class="op">=</span> <span class="fl">17</span><span class="op">;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>bet <span class="op">=</span> <span class="fl">43</span><span class="op">/</span><span class="fl">3</span><span class="op">;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">5</span>)<span class="op">;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>[xi<span class="op">,</span> w1i<span class="op">,</span> w2i] <span class="op">=</span> nonlinear_shooting_newton(f<span class="op">,</span> fy<span class="op">,</span> fyp<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet<span class="op">,</span> tol<span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x) ((x <span class="op">.^</span> <span class="fl">2</span>) <span class="op">+</span> (<span class="fl">16</span> <span class="op">./</span> x))<span class="op">;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>y_eksak <span class="op">=</span> sln(xi)<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>[xi<span class="op">,</span> w1i<span class="op">',</span> y_eksak]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hold</span> on<span class="op">;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">fplot</span>(sln<span class="op">,</span> [a<span class="op">,</span>b]<span class="op">,</span> <span class="st">'k'</span>)<span class="op">;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(xi<span class="op">,</span> w1i<span class="op">',</span> <span class="st">'r'</span>)<span class="op">;</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'Eksak'</span><span class="op">,</span> <span class="st">'Aproksimasi'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans =

    1.0000   17.0000   17.0000
    1.1000   15.7555   15.7555
    1.2000   14.7734   14.7733
    1.3000   13.9978   13.9977
    1.4000   13.3886   13.3886
    1.5000   12.9167   12.9167
    1.6000   12.5601   12.5600
    1.7000   12.3018   12.3018
    1.8000   12.1289   12.1289
    1.9000   12.0311   12.0311
    2.0000   12.0000   12.0000
    2.1000   12.0291   12.0290
    2.2000   12.1128   12.1127
    2.3000   12.2465   12.2465
    2.4000   12.4267   12.4267
    2.5000   12.6500   12.6500
    2.6000   12.9139   12.9138
    2.7000   13.2159   13.2159
    2.8000   13.5543   13.5543
    2.9000   13.9272   13.9272
    3.0000   14.3333   14.3333
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul6_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Jika kita run script file tersebut, maka program akan mengeluarkan dua macam output, yaitu tabel serta plot perbandingan solusi eksak dan aproksimasi seperti di bawah ini:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="attachment:image.png" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="attachment:image-2.png" class="img-fluid figure-img"></p>
<figcaption>image-2.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="linear-finite-difference" class="level2">
<h2 class="anchored" data-anchor-id="linear-finite-difference"><em>Linear Finite Difference</em></h2>
<p>Metode ini digunakan untuk mengaproksimasi masalah linear dalam bentuk:</p>
<span class="math display">\[\begin{gathered}
y^{\prime \prime}=p(x) y^{\prime}+q(x) y+r(x), \quad a \leq x \leq b \\
y(a)=\alpha, y(b)=\beta
\end{gathered}\]</span>
<p>Penyelesaiannya adalah dengan persamaan-persamaan berikut:</p>
<span class="math display">\[\begin{gathered}
w_{0}=\alpha, \quad w_{N+1}=\beta \\
-\left(1+\frac{h}{2} p\left(x_{i}\right)\right) w_{i-1}+\left(2+h^{2} q\left(x_{i}\right)\right) w_{i}-\left(1-\frac{h}{2} p\left(x_{i}\right)\right) w_{i+1}=-h^{2} r\left(x_{i}\right)
\end{gathered}\]</span>
<p>Bentuk tersebut dapat dibuat sebagai suatu SPL:</p>
<p><span class="math display">\[
A \mathbf{w}=\mathbf{b}
\]</span></p>
<p><img src="./pdnum6_Picture1.png" class="img-fluid"></p>
<p><span class="math inline">\(\mathbf{w}=\left[\begin{array}{c}w_{1} \\ w_{2} \\ \vdots \\ w_{N-1} \\ w_{N}\end{array}\right], \quad\)</span> and <span class="math inline">\(\quad \mathbf{b}=\left[\begin{array}{c}-h^{2} r\left(x_{1}\right)+\left(1+\frac{h}{2} p\left(x_{1}\right)\right) w_{0} \\ -h^{2} r\left(x_{2}\right) \\ \vdots \\ -h^{2} r\left(x_{N-1}\right) \\ -h^{2} r\left(x_{N}\right)+\left(1-\frac{h}{2} p\left(x_{N}\right)\right) w_{N+1}\end{array}\right]\)</span>.</p>
<p>Menurut buku, SPL tersebut sebaiknya diselesaikan dengan metode faktorisasi Crout (algoritma 6.7). (Intinya, mumpung A adalah matriks tridiagonal, algoritma ini nyari inverse A secara linier, makanya runtime dari algortima ini adalah <span class="math inline">\(O(n)\)</span>)</p>
<p>Namun, tentunya kita bebas menyelesaikan SPLnya dengan cara apapun, bahkan dengan cara iteratif seperti Gauss-Seidel</p>
<section id="function-file-dari-pseudocode-1" class="level3">
<h3 class="anchored" data-anchor-id="function-file-dari-pseudocode-1">Function file (dari pseudocode)</h3>
<div id="cell-59" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [xt<span class="op">,</span>w]<span class="op">=</span>linfdm_pseudocode(p<span class="op">,</span>q<span class="op">,</span>r<span class="op">,</span>a_boundary<span class="op">,</span>b_boundary<span class="op">,</span>alpha<span class="op">,</span><span class="fu">beta</span><span class="op">,</span>n)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  h<span class="op">=</span>(b_boundary<span class="op">-</span>a_boundary)<span class="op">/</span>(n<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%stepsize</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  a<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%diagonal sistem persamaannya</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  b<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">% right diagonal sistem persamaannya</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  c<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%left diagonal sistem persamaannya</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  d<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%vektor b (Ay=b) pada sistem persamaannya</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  l<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">% main diagonal of lower triangle matrix</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  u<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%right diagonal of upper triangle matrix</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  z<span class="op">=</span> <span class="fu">zeros</span>(n<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%solution of Lz=b</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  w<span class="op">=</span><span class="fu">zeros</span>(n<span class="op">+</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">%solusi aproksimasi dengan linear fdm</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  xt<span class="op">=</span>[a_boundary<span class="op">:</span>h<span class="op">:</span>b_boundary]<span class="op">;</span> <span class="co">%mesh_point</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  x<span class="op">=</span>a_boundary<span class="op">+</span>h<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">%konstruksi matrix tridiagonalnya</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  a(<span class="fl">1</span>)<span class="op">=</span><span class="fl">2</span><span class="op">+</span>(h<span class="op">^</span><span class="fl">2</span>)<span class="op">*</span>q(x)<span class="op">;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  b(<span class="fl">1</span>)<span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>p(x)<span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  d(<span class="fl">1</span>)<span class="op">=-</span>h<span class="op">^</span><span class="fl">2</span><span class="op">*</span>r(x) <span class="op">+</span>(<span class="fl">1</span><span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>p(x))<span class="op">*</span>alpha<span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span><span class="op">:</span>n<span class="op">-</span><span class="fl">1</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span> a_boundary<span class="op">+</span><span class="fu">i</span><span class="op">*</span>h<span class="op">;</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    a(<span class="fu">i</span>)<span class="op">=</span><span class="fl">2</span><span class="op">+</span>h<span class="op">^</span><span class="fl">2</span><span class="op">*</span>q(x)<span class="op">;</span> <span class="co">%diagonal</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    b(<span class="fu">i</span>)<span class="op">=-</span><span class="fl">1</span><span class="op">+</span>(h<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>p(x)<span class="op">;</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    c(<span class="fu">i</span>)<span class="op">=-</span><span class="fl">1</span><span class="op">-</span>(h<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>p(x)<span class="op">;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    d(<span class="fu">i</span>)<span class="op">=-</span>h<span class="op">^</span><span class="fl">2</span><span class="op">*</span>r(x)<span class="op">;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  x<span class="op">=</span>b_boundary<span class="op">-</span>h<span class="op">;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  a(n)<span class="op">=</span><span class="fl">2</span><span class="op">+</span>h<span class="op">^</span><span class="fl">2</span><span class="op">*</span>q(x)<span class="op">;</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  c(n)<span class="op">=-</span><span class="fl">1</span><span class="op">-</span>(h<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>p(x)<span class="op">;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  d(n)<span class="op">=-</span>h<span class="op">^</span><span class="fl">2</span><span class="op">*</span>r(x)<span class="op">+</span>(<span class="fl">1</span><span class="op">-</span>(h<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>p(x))<span class="op">*</span><span class="fu">beta</span><span class="op">;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">%matriks tridiagonalnya sudah didapatkan,</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">%akan diselesaikan dengan LU Decomposition (crout factorization)</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  l(<span class="fl">1</span>)<span class="op">=</span> a(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  u(<span class="fl">1</span>)<span class="op">=</span>b(<span class="fl">1</span>)<span class="op">/</span>a(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  z(<span class="fl">1</span>)<span class="op">=</span>d(<span class="fl">1</span>)<span class="op">/</span>l(<span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span><span class="op">=</span> <span class="fl">2</span><span class="op">:</span>n<span class="op">-</span><span class="fl">1</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    l(<span class="fu">i</span>)<span class="op">=</span>a(<span class="fu">i</span>)<span class="op">-</span>c(<span class="fu">i</span>)<span class="op">*</span>u(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    u(<span class="fu">i</span>)<span class="op">=</span>b(<span class="fu">i</span>)<span class="op">/</span>l(<span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    z(<span class="fu">i</span>)<span class="op">=</span>(d(<span class="fu">i</span>)<span class="op">-</span>c(<span class="fu">i</span>)<span class="op">*</span>z(<span class="fu">i</span><span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>l(<span class="fu">i</span>)<span class="op">;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  l(n)<span class="op">=</span>a(n)<span class="op">-</span>c(n)<span class="op">*</span>u(n<span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  z(n)<span class="op">=</span>(d(n)<span class="op">-</span>c(n)<span class="op">*</span>z(n<span class="op">-</span><span class="fl">1</span>))<span class="op">/</span>l(n)<span class="op">;</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">%konstruksi akhir w-nya</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  w(n<span class="op">+</span><span class="fl">1</span>)<span class="op">=</span><span class="fu">beta</span><span class="op">;</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  w(n)<span class="op">=</span>z(n)<span class="op">;</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> n<span class="op">-</span><span class="fl">1</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    w(<span class="fu">i</span>)<span class="op">=</span>z(<span class="fu">i</span>)<span class="op">-</span>u(<span class="fu">i</span>)<span class="op">*</span>w(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  w<span class="op">=</span>[alpha<span class="op">;</span>w]<span class="op">;</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  xt<span class="op">=</span><span class="fu">transpose</span>(xt)<span class="op">;</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-file-dengan-solusi-spl-secara-eksakinvers" class="level3">
<h3 class="anchored" data-anchor-id="function-file-dengan-solusi-spl-secara-eksakinvers">Function file (dengan solusi SPL secara eksak/invers)</h3>
<div id="cell-61" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> [x<span class="op">,</span> w_grid] <span class="op">=</span> linear_fd_eksak(p<span class="op">,</span> q<span class="op">,</span> r<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> N<span class="op">,</span> alph<span class="op">,</span> bet)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">% bikin array x</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> (N<span class="op">+</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> a <span class="op">:</span> h <span class="op">:</span> b<span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">% susun matriks A dan vektor b</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  A <span class="op">=</span> <span class="fu">zeros</span>(N<span class="op">,</span> N)<span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  b <span class="op">=</span> <span class="op">-</span>h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> r(x(<span class="fl">2</span><span class="op">:</span>N<span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">% kasus khusus untuk baris pertama</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  b(<span class="fl">1</span>) <span class="op">+=</span> (<span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> p(x(<span class="fl">2</span>))) <span class="op">*</span> alph<span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  A(<span class="fl">1</span><span class="op">,</span> <span class="fl">1</span>) <span class="op">+=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> q(x(<span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  A(<span class="fl">1</span><span class="op">,</span> <span class="fl">2</span>) <span class="op">+=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> p(x(<span class="fl">2</span>))<span class="op">;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">% kasus khusus untuk baris terakhir</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  A(N<span class="op">,</span> N<span class="op">-</span><span class="fl">1</span>) <span class="op">+=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> p(x(N<span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  A(N<span class="op">,</span> N) <span class="op">+=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> q(x(N<span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  b(N) <span class="op">+=</span> (<span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> p(x(N<span class="op">+</span><span class="fl">1</span>))) <span class="op">*</span> bet<span class="op">;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">% untuk baris kedua hingga kedua-terakhir</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="fu">i</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">:</span> (N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    A(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">-</span><span class="fl">1</span>) <span class="op">+=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">-</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> p(x(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    A(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span>) <span class="op">+=</span> <span class="fl">2</span> <span class="op">+</span> h<span class="op">^</span><span class="fl">2</span> <span class="op">*</span> q(x(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    A(<span class="fu">i</span><span class="op">,</span> <span class="fu">i</span><span class="op">+</span><span class="fl">1</span>) <span class="op">+=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> h<span class="op">/</span><span class="fl">2</span> <span class="op">*</span> p(x(<span class="fu">i</span><span class="op">+</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">endfor</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">% selesaikan SPL</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  w <span class="op">=</span> A <span class="op">\</span> b<span class="op">';</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">% w baru mengandung w1, ..., w_N</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">% gabungkan dengan w0 (alpha) dan w_{N+1} (beta)</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  w_grid <span class="op">=</span> [alph w<span class="op">'</span> bet]<span class="op">;</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="cf">endfunction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contoh-linear-finite-difference" class="level3">
<h3 class="anchored" data-anchor-id="contoh-linear-finite-difference">Contoh <em>Linear Finite Difference</em></h3>
<p>Akan kita uji dengan masalah nilai batas:</p>
<p><span class="math display">\[
\begin{aligned}
y^{\prime \prime} &amp; =-\frac{4}{x} y^{\prime}-\frac{2}{x^2} y+\frac{2 \ln x}{x^2}, \quad 1 \leq x \leq 2 \\
y(1) &amp; =\frac{1}{2}, \quad y(2)=\ln 2
\end{aligned}
\]</span> Solusi eksak: <span class="math display">\[
y(x)=\frac{4}{x}-\frac{2}{x^2}+\ln x-\frac{3}{2}
\]</span></p>
<div id="cell-65" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode octave code-with-copy"><code class="sourceCode octave"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span> @(x) (<span class="op">-</span><span class="fl">4</span><span class="op">./</span>x)<span class="op">;</span> <span class="co">%function p(x)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>q<span class="op">=</span> @(x) (<span class="op">-</span><span class="fl">2</span><span class="op">./</span>x<span class="op">.^</span><span class="fl">2</span>)<span class="op">;</span><span class="co">%function q(x)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>r<span class="op">=</span>@(x) <span class="fl">2</span><span class="op">*</span><span class="fu">log</span>(x)<span class="op">./</span>(x<span class="op">.^</span><span class="fl">2</span>)<span class="op">;</span> <span class="co">%function r(x)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span><span class="fl">1</span><span class="op">;</span> <span class="co">%batas kiri domain</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span><span class="fl">2</span><span class="op">;</span> <span class="co">%batas kanan domain</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>N<span class="op">=</span><span class="fl">20</span><span class="op">;</span> <span class="co">%banyaknya partisi</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>alph<span class="op">=</span><span class="fl">0.5</span><span class="op">;</span> <span class="co">%y(a)=alpha</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>bet<span class="op">=</span><span class="fu">log</span>(<span class="fl">2</span>)<span class="op">;</span> <span class="co">%y(b)=beta</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">,</span>w_grid] <span class="op">=</span> linear_fd_eksak(p<span class="op">,</span>q<span class="op">,</span>r<span class="op">,</span>a<span class="op">,</span>b<span class="op">,</span>N<span class="op">,</span>alph<span class="op">,</span>bet)<span class="op">;</span> <span class="co">%memangil fungsinya</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sln <span class="op">=</span> @(x) <span class="fl">4</span><span class="op">./</span>x <span class="op">-</span> <span class="fl">2</span><span class="op">./</span>(x<span class="op">.^</span><span class="fl">2</span>) <span class="op">+</span> <span class="fu">log</span>(x) <span class="op">-</span> <span class="fl">1.5</span><span class="op">;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>y_eksak <span class="op">=</span> sln(x_grid)<span class="op">;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>err <span class="op">=</span> <span class="fu">abs</span>(y_eksak <span class="op">-</span> w_grid)<span class="op">;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">%bikin tabel dan grafiknya :D</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>[x_grid<span class="op">',</span> w_grid<span class="op">',</span> y_eksak<span class="op">',</span> err<span class="op">'</span>]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hold</span> on<span class="op">;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">fplot</span>(sln<span class="op">,</span> [a<span class="op">,</span>b]<span class="op">,</span> <span class="st">'b'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(x_grid<span class="op">,</span> w_grid<span class="op">,</span> <span class="st">'r'</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'Eksak'</span><span class="op">,</span> <span class="st">'Aproksimasi'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ans =

   1.0000   0.5000   0.5000        0
   1.0476   0.5425   0.5424   0.0001
   1.0952   0.5759   0.5758   0.0001
   1.1429   0.6024   0.6023   0.0001
   1.1905   0.6233   0.6232   0.0001
   1.2381   0.6397   0.6396   0.0001
   1.2857   0.6527   0.6525   0.0001
   1.3333   0.6628   0.6627   0.0001
   1.3810   0.6707   0.6706   0.0001
   1.4286   0.6768   0.6767   0.0001
   1.4762   0.6814   0.6813   0.0001
   1.5238   0.6850   0.6849   0.0001
   1.5714   0.6876   0.6875   0.0001
   1.6190   0.6895   0.6895   0.0001
   1.6667   0.6909   0.6908   0.0000
   1.7143   0.6918   0.6918   0.0000
   1.7619   0.6924   0.6924   0.0000
   1.8095   0.6928   0.6928   0.0000
   1.8571   0.6930   0.6930   0.0000
   1.9048   0.6931   0.6931   0.0000
   1.9524   0.6931   0.6931   0.0000
   2.0000   0.6931   0.6931   0.0000
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modul6_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>