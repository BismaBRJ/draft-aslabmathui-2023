{
  "hash": "11532e5915ab4e568d89741c1ddb64f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pertemuan 7: MANOVA\"\nsubtitle: \"Pengantar Multivariat\"\nimage: static\\fstat_anova.png\ndescription: \"Offline di Departemen Matematika\"\ndate: 11/26/2024\npage-navigation: true\nformat: html\n---\n\n\n# ANOVA\n\nHipotesis\n\n$H_0: \\mu_1 = \\mu_2 = ... = \\mu_k$\n\n$H_1: \\text{Tidak Demikian}$\n\nStatistik Uji:\n\n![](static\\fstat_anova.png)\n\nAturan Penolakan:\n\nTolak $H_0$ pada tingkat $\\alpha$ jika $F > F_\\alpha$\n\n## Manual\n\nKita akan menggunakan data dari tabel 6.2 buku Rencher (Rootstock Data)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.delim(\"https://raw.githubusercontent.com/kmyafi/Multivariate-Statistics-R/main/Data/T6_2_ROOT.DAT\",\n                 sep = \"\", header = FALSE)\ncolnames(df) <- c('Rootstock', 'y1', 'y2', 'y3', 'y4')\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Rootstock   y1    y2   y3    y4\n1          1 1.11 2.569 3.58 0.760\n2          1 1.19 2.928 3.75 0.821\n3          1 1.09 2.865 3.93 0.928\n4          1 1.25 3.844 3.94 1.009\n5          1 1.11 3.027 3.60 0.766\n6          1 1.08 2.336 3.51 0.726\n7          1 1.11 3.211 3.98 1.209\n8          1 1.16 3.037 3.62 0.750\n9          2 1.05 2.074 4.09 1.036\n10         2 1.17 2.885 4.06 1.094\n11         2 1.11 3.378 4.87 1.635\n12         2 1.25 3.906 4.98 1.517\n13         2 1.17 2.782 4.38 1.197\n14         2 1.15 3.018 4.65 1.244\n15         2 1.17 3.383 4.69 1.495\n16         2 1.19 3.447 4.40 1.026\n17         3 1.07 2.505 3.76 0.912\n18         3 0.99 2.315 4.44 1.398\n19         3 1.06 2.667 4.38 1.197\n20         3 1.02 2.390 4.67 1.613\n21         3 1.15 3.021 4.48 1.476\n22         3 1.20 3.085 4.78 1.571\n23         3 1.20 3.308 4.57 1.506\n24         3 1.17 3.231 4.56 1.458\n25         4 1.22 2.838 3.89 0.944\n26         4 1.03 2.351 4.05 1.241\n27         4 1.14 3.001 4.05 1.023\n28         4 1.01 2.439 3.92 1.067\n29         4 0.99 2.199 3.27 0.693\n30         4 1.11 3.318 3.95 1.085\n31         4 1.20 3.601 4.27 1.242\n32         4 1.08 3.291 3.85 1.017\n33         5 0.91 1.532 4.04 1.084\n34         5 1.15 2.552 4.16 1.151\n35         5 1.14 3.083 4.79 1.381\n36         5 1.05 2.330 4.42 1.242\n37         5 0.99 2.079 3.47 0.673\n38         5 1.22 3.366 4.41 1.137\n39         5 1.05 2.416 4.64 1.455\n40         5 1.13 3.100 4.57 1.325\n41         6 1.11 2.813 3.76 0.800\n42         6 0.75 0.840 3.14 0.606\n43         6 1.05 2.199 3.75 0.790\n44         6 1.02 2.132 3.99 0.853\n45         6 1.05 1.949 3.34 0.610\n46         6 1.07 2.251 3.21 0.562\n47         6 1.13 3.064 3.63 0.707\n48         6 1.11 2.469 3.95 0.952\n```\n\n\n:::\n:::\n\n\nPastikan tipe data variabel yang menyatakan anggota kelompok sebagai `factor`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Rootstock <- as.factor(df$Rootstock)\n```\n:::\n\n\nMisalkan ingin diuji apakah mean dari variabel y1 sama untuk setiap kelompok.\n\nAkan dicari nilai $n_k$, $\\bar{y}_{1k}$ dan vektor mean $\\bf{\\bar{y}_1}$ untuk menghitung nilai statistik uji $F$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Jumlah Group\nk <- 6\n\nn1 <- nrow(df[df$Rootstock == \"1\", ])\nn2 <- nrow(df[df$Rootstock == \"2\", ])\nn3 <- nrow(df[df$Rootstock == \"3\", ])\nn4 <- nrow(df[df$Rootstock == \"4\", ])\nn5 <- nrow(df[df$Rootstock == \"5\", ])\nn6 <- nrow(df[df$Rootstock == \"6\", ])\n\nmean1 <- mean(as.matrix(df[df$Rootstock == \"1\", \"y1\"]))\nmean2 <- mean(as.matrix(df[df$Rootstock == \"2\", \"y1\"]))\nmean3 <- mean(as.matrix(df[df$Rootstock == \"3\", \"y1\"]))\nmean4 <- mean(as.matrix(df[df$Rootstock == \"4\", \"y1\"]))\nmean5 <- mean(as.matrix(df[df$Rootstock == \"5\", \"y1\"]))\nmean6 <- mean(as.matrix(df[df$Rootstock == \"6\", \"y1\"]))\n\noverallMean <- mean(df$y1)\n\nSSH <- sum(n1 * (mean1 - overallMean)^2 + \n             n2 * (mean2 - overallMean)^2 + \n             n3 * (mean3 - overallMean)^2 +\n             n4 * (mean4 - overallMean)^2 +\n             n5 * (mean5 - overallMean)^2 +\n             n6 * (mean6 - overallMean)^2); SSH\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.07356042\n```\n\n\n:::\n\n```{.r .cell-code}\nMSH <- SSH/(k-1); MSH\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01471208\n```\n\n\n:::\n\n```{.r .cell-code}\nSSE <- sum(c((as.matrix(df[df$Rootstock == \"1\", \"y1\"]) - mean1)^2,\n             (as.matrix(df[df$Rootstock == \"2\", \"y1\"]) - mean2)^2,\n             (as.matrix(df[df$Rootstock == \"3\", \"y1\"]) - mean3)^2,\n             (as.matrix(df[df$Rootstock == \"4\", \"y1\"]) - mean4)^2,\n             (as.matrix(df[df$Rootstock == \"5\", \"y1\"]) - mean5)^2,\n             (as.matrix(df[df$Rootstock == \"6\", \"y1\"]) - mean6)^2)); SSE\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3199875\n```\n\n\n:::\n\n```{.r .cell-code}\nMSE <- SSE/(k*(n1-1)) ; MSE\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.00761875\n```\n\n\n:::\n\n```{.r .cell-code}\nFvalue <- MSH/MSE; Fvalue\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.931036\n```\n\n\n:::\n:::\n\n\nBandingkan dengan nilai $F$ tabel\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqf(0.95, k-1, k*(n1-1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.437693\n```\n\n\n:::\n:::\n\n\nAtau p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\npf(Fvalue, k-1, k*(n1-1), lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1094018\n```\n\n\n:::\n:::\n\n\nKesimpulannya?\n\n## Fungsi `aov()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_result <- aov(df$y1 ~ df$Rootstock, data = df)\nsummary(anova_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq  Mean Sq F value Pr(>F)\ndf$Rootstock  5 0.0736 0.014712   1.931  0.109\nResiduals    42 0.3200 0.007619               \n```\n\n\n:::\n:::\n\n\nApakah sama?\n\n# MANOVA\n\nHipotesis:\n\n$H_0: \\bf{\\mu_1} = \\bf{\\mu_2} = ... = \\bf{\\mu_k}$\n\n$H_1: \\text{Tidak Demikian}$\n\n## Manual\n\nDengan data yang sama, akan diuji apakah $\\bf{\\mu_1} = \\bf{\\mu_2} = ... = \\bf{\\mu_k}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- cbind(df$y1,df$y2,df$y3,df$y4); y\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      [,1]  [,2] [,3]  [,4]\n [1,] 1.11 2.569 3.58 0.760\n [2,] 1.19 2.928 3.75 0.821\n [3,] 1.09 2.865 3.93 0.928\n [4,] 1.25 3.844 3.94 1.009\n [5,] 1.11 3.027 3.60 0.766\n [6,] 1.08 2.336 3.51 0.726\n [7,] 1.11 3.211 3.98 1.209\n [8,] 1.16 3.037 3.62 0.750\n [9,] 1.05 2.074 4.09 1.036\n[10,] 1.17 2.885 4.06 1.094\n[11,] 1.11 3.378 4.87 1.635\n[12,] 1.25 3.906 4.98 1.517\n[13,] 1.17 2.782 4.38 1.197\n[14,] 1.15 3.018 4.65 1.244\n[15,] 1.17 3.383 4.69 1.495\n[16,] 1.19 3.447 4.40 1.026\n[17,] 1.07 2.505 3.76 0.912\n[18,] 0.99 2.315 4.44 1.398\n[19,] 1.06 2.667 4.38 1.197\n[20,] 1.02 2.390 4.67 1.613\n[21,] 1.15 3.021 4.48 1.476\n[22,] 1.20 3.085 4.78 1.571\n[23,] 1.20 3.308 4.57 1.506\n[24,] 1.17 3.231 4.56 1.458\n[25,] 1.22 2.838 3.89 0.944\n[26,] 1.03 2.351 4.05 1.241\n[27,] 1.14 3.001 4.05 1.023\n[28,] 1.01 2.439 3.92 1.067\n[29,] 0.99 2.199 3.27 0.693\n[30,] 1.11 3.318 3.95 1.085\n[31,] 1.20 3.601 4.27 1.242\n[32,] 1.08 3.291 3.85 1.017\n[33,] 0.91 1.532 4.04 1.084\n[34,] 1.15 2.552 4.16 1.151\n[35,] 1.14 3.083 4.79 1.381\n[36,] 1.05 2.330 4.42 1.242\n[37,] 0.99 2.079 3.47 0.673\n[38,] 1.22 3.366 4.41 1.137\n[39,] 1.05 2.416 4.64 1.455\n[40,] 1.13 3.100 4.57 1.325\n[41,] 1.11 2.813 3.76 0.800\n[42,] 0.75 0.840 3.14 0.606\n[43,] 1.05 2.199 3.75 0.790\n[44,] 1.02 2.132 3.99 0.853\n[45,] 1.05 1.949 3.34 0.610\n[46,] 1.07 2.251 3.21 0.562\n[47,] 1.13 3.064 3.63 0.707\n[48,] 1.11 2.469 3.95 0.952\n```\n\n\n:::\n\n```{.r .cell-code}\ntotalmeans <- colMeans(y); totalmeans\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.102708 2.758854 4.087292 1.083000\n```\n\n\n:::\n\n```{.r .cell-code}\nn <- dim(df)[1] / length(unique(df$Rootstock)); n\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8\n```\n\n\n:::\n\n```{.r .cell-code}\ndf.group <- split(df[,2:5], df$Rootstock)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.means <- sapply(df.group, function(x) {\n  apply(x, 2, mean)\n}, simplify = 'data.frame')\n\ndf.means\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          1        2        3       4       5        6\ny1 1.137500 1.157500 1.107500 1.09750 1.08000 1.036250\ny2 2.977125 3.109125 2.815250 2.87975 2.55725 2.214625\ny3 3.738750 4.515000 4.455000 3.90625 4.31250 3.596250\ny4 0.871125 1.280500 1.391375 1.03900 1.18100 0.735000\n```\n\n\n:::\n:::\n\n\n### Matriks H\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Matriks H ----\nH <- matrix(data = 0, nrow = 4, ncol = 4)\nfor (i in 1:dim(H)[1]) {\n  for (j in 1:i) {\n    H[i,j] <- n * sum((df.means[i,] - totalmeans[i]) * (df.means[j,] - totalmeans[j]))\n    H[j,i] <- n * sum((df.means[j,] - totalmeans[j]) * (df.means[i,] - totalmeans[i]))\n  }\n}\nH\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           [,1]      [,2]      [,3]     [,4]\n[1,] 0.07356042 0.5373852 0.3322646 0.208470\n[2,] 0.53738521 4.1996619 2.3553885 1.637108\n[3,] 0.33226458 2.3553885 6.1139354 3.781044\n[4,] 0.20847000 1.6371084 3.7810438 2.493091\n```\n\n\n:::\n:::\n\n\n### Matriks E\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Matriks E ----\nE <- matrix(data = 0, nrow = 4, ncol = 4)\nfor (i in 1:dim(E)[1]) {\n  for (j in 1:i) {\n    b <- c() \n    for (k in df.group) {\n      a <- sum((k[,i] - mean(k[,i])) * (k[,j] - mean(k[,j])))\n      b <- append(b, a)\n    }\n    E[i,j] <- sum(b)\n    E[j,i] <- sum(b)\n  }\n}\nE\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          [,1]      [,2]      [,3]     [,4]\n[1,] 0.3199875  1.696564 0.5540875 0.217140\n[2,] 1.6965637 12.142790 4.3636125 2.110214\n[3,] 0.5540875  4.363613 4.2908125 2.481656\n[4,] 0.2171400  2.110214 2.4816563 1.722525\n```\n\n\n:::\n:::\n\n\n## Fungsi `manova()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmanova_result <- manova(cbind(y1,y2,y3,y4) ~ Rootstock, data = df)\n```\n:::\n\n\n## Wilk's Lambda\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\nLambda <- det(E)/det(E + H); Lambda\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1540077\n```\n\n\n:::\n\n```{.r .cell-code}\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Wilks\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df   Wilks approx F num Df den Df    Pr(>F)    \nRootstock  5 0.15401   4.9369     20  130.3 7.714e-09 ***\nResiduals 42                                             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n## Roy's Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\nEinvH.eigen <- eigen(solve(E) %*% H)\nroy.stat <- EinvH.eigen$values[1]; roy.stat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.875671\n```\n\n\n:::\n\n```{.r .cell-code}\ntheta <- roy.stat/(1+roy.stat); theta\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6522551\n```\n\n\n:::\n\n```{.r .cell-code}\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Roy\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df    Roy approx F num Df den Df    Pr(>F)    \nRootstock  5 1.8757   15.756      5     42 1.002e-08 ***\nResiduals 42                                            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n## Pillai Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\npillai.stat <- sum(diag(solve(E + H) %*% H)); pillai.stat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.305472\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(EinvH.eigen$values / (1 + EinvH.eigen$values))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.305472\n```\n\n\n:::\n\n```{.r .cell-code}\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Pillai\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df Pillai approx F num Df den Df    Pr(>F)    \nRootstock  5 1.3055   4.0697     20    168 1.983e-07 ***\nResiduals 42                                            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n## Lawley-Hotelling Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dengan matriks E dan H\nlawhot.stat <- sum(diag(solve(E) %*% H)); lawhot.stat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.921368\n```\n\n\n:::\n\n```{.r .cell-code}\nsum(EinvH.eigen$values)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.921368\n```\n\n\n:::\n\n```{.r .cell-code}\n# dengan fungsi `manova()`\nsummary(manova_result, test =\"Hotelling-Lawley\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df Hotelling-Lawley approx F num Df den Df    Pr(>F)    \nRootstock  5           2.9214   5.4776     20    150 2.568e-10 ***\nResiduals 42                                                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}