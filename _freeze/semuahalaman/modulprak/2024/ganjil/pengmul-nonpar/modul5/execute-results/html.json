{
  "hash": "77287f951c45d1aa50f9a2f3dcc1f4c8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pertemuan 5: Uji Beda Mean Data Multivariat\"\nsubtitle: \"Pengantar Multivariat\"\nimage: static\\soal1_bedamean.png\ndescription: \"Offline di Departemen Matematika\"\ndate: 11/12/2024\npage-navigation: true\nformat: html\n---\n\n\n# Review Uji Beda Mean 1 Sampel Univariat\n\nDalam uji beda mean 1 sampel univariat, hipotesis yang ingin kita uji adalah\n\n| $H_0: \\mu = \\mu_0$\n| $H_1: \\mu \\neq \\mu_0$\n\ndengan $\\mu_0$ adalah nilai mean yang ditentukan.\n\n## Ketika Variansi Diketahui\n\nAsumsi n observasi sampel acak $y_1, y_2, ..., y_n$ berdistribusi $N(\\mu,\\sigma^2)$ dengan $\\sigma^2$ diketahui, maka digunakan statistik uji $z$ yaitu\n\n![](static\\z_univ_known.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $|z| \\geq z_{\\alpha/2}$\n\nAtau dengan distribusi chi-square\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $z^2 \\geq \\chi^2_{\\alpha, 1}$\n\n### Implementasi Program\n\nUji $z$ dapat dilakukan dengan memanggil fungsi `z.test()` pada r dari library `BSDA`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(BSDA)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(88, 92, 94, 94, 96, 97, 97, 97, 99, 99, 105, 109, 109, 109, 110, 112, 112, 113, 114, 115)\nz.test(data, mu = 100, sigma.x = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne-sample z-Test\n\ndata:  data\nz = 0.90933, p-value = 0.3632\nalternative hypothesis: true mean is not equal to 100\n95 percent confidence interval:\n  96.47608 109.62392\nsample estimates:\nmean of x \n   103.05 \n```\n\n\n:::\n:::\n\n\n## Ketika Variansi Tidak Diketahui\n\nKetika variansi tidak diketahui, gunakan estimasi sampel dari $\\sigma^2$ yaitu $s^2$, di mana\n\n![](static\\sample_var_univ.png)\n\nUji yang digunakan adalah uji $t$, dengan statistik uji:\n\n![](static\\t_univ_unknown.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $|t| \\geq t_{\\alpha/2, n-1}$\n\n### Implementasi Program\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- c(88, 92, 94, 94, 96, 97, 97, 97, 99, 99, 105, 109, 109, 109, 110, 112, 112, 113, 114, 115)\n\nt.test(data, mu=100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  data\nt = 1.5976, df = 19, p-value = 0.1266\nalternative hypothesis: true mean is not equal to 100\n95 percent confidence interval:\n  99.05424 107.04576\nsample estimates:\nmean of x \n   103.05 \n```\n\n\n:::\n:::\n\n\n# Uji Beda Mean 1 Sampel Multivariat\n\nDalam uji beda mean 1 sampel multivariat, hipotesis yang ingin kita uji adalah\n\n| $H_0: \\pmb{\\mu} = \\pmb{\\mu_0}$\n| $H_1: \\pmb{\\mu} \\neq \\pmb{\\mu_0}$\n\ndengan $\\pmb{\\mu_0}$ adalah vektor mean yang ditentukan.\n\n## Ketika Variansi Diketahui\n\nAsumsi n vektor observasi sampel acak $\\pmb{y}_1, \\pmb{y}_2, ..., \\pmb{y}_n$ berdistribusi $N_p(\\pmb{\\mu},\\pmb{\\Sigma})$ dengan $\\pmb{\\Sigma}$ diketahui, maka digunakan statistik uji $Z^2$ yaitu\n\n![](static\\z_multiv_known.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $Z^2 > \\chi^2_{\\alpha, p}$\n\n### Implementasi Program\n\nDigunakan data dari tabel 3.7 (Ramus Bone) dari buku *Methods of Multivariate Analysis by Alvin C. Rencher, William F. Christensen. 3rd Edition*\n\nMisalkan ingin diuji apakah $(\\mu_1, \\mu_2, \\mu_3, \\mu_4) = (48, 49, 50, 51)$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv('https://raw.githubusercontent.com/farhanage/dataset-for-study/refs/heads/main/Analisis%20Multivariat/Tabel%203.7%20(Ramus%20Bone%20Length%20at%20Four%20Ages%20).csv', sep=';')[2:5]\n\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    y1   y2   y3   y4\n1 47.8 48.8 49.0 49.7\n2 46.4 47.3 47.7 48.4\n3 46.3 46.8 47.8 48.5\n4 45.1 45.3 46.1 47.2\n5 47.6 48.5 48.9 49.3\n6 52.5 53.2 53.3 53.7\n```\n\n\n:::\n:::\n\n\nMisalkan diketahui $\\pmb{\\Sigma}$ adalah matrix diagonal dengan entri-entri diagonalnya bernilai 3.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- c(48, 49, 50, 51)\nn <- nrow(data)\np <- length(mu)\n\nybar <- colMeans(data)\nSigma <- diag(3, ncol=4, nrow=4)\n```\n:::\n\n\nMaka hitung statistik uji:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nZ_sq <- n * t(ybar-mu) %*% solve(Sigma) %*% (ybar-mu)\nZ_sq\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]\n[1,] 8.980333\n```\n\n\n:::\n\n```{.r .cell-code}\nqchisq(p=0.05, df=p, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.487729\n```\n\n\n:::\n:::\n\n\nApa kesimpulannya?\n\n## Ketika Variansi Tidak Diketahui\n\nKetika variansi tidak diketahui, gunakan estimasi sampel dari $\\pmb{\\Sigma}$ yaitu $\\textbf{S}$, di mana\n\n![](static\\sample_var_multiv1.png)\n![](static\\sample_var_multiv2.png)\n\nUji yang digunakan adalah uji *Hotelling's* $T^2$, dengan statistik uji:\n\n![](static\\t_multiv_unknown.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $T^2 > T^2_{\\alpha, p, n-1}$\n\nStatistik uji $T^2$ dapat dibawa ke distribusi $F$ dengan hubungan:\n\n![](static\\tsq_f.png)\n\nDalam uji beda mean 1 sampel, nilai $v$ adalah $n-1$\n\n### Implementasi Program\n\n\n::: {.cell}\n\n```{.r .cell-code}\nS <- cov(data)\n\nT2 <- n * t(ybar - mu) %*% solve(S) %*% (ybar - mu)\nT2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]\n[1,] 1.792636\n```\n\n\n:::\n:::\n\n\nCek nilai tabel $T^2_{\\alpha, p, n-1}$ di buku\n\nAtau dengan Pendekatan distribusi F\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF <- (n - p)/(n*p - p)*T2\nF\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]\n[1,] 0.377397\n```\n\n\n:::\n\n```{.r .cell-code}\n# Titik kritis f\nqf(0.05, p, n-p, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.006917\n```\n\n\n:::\n\n```{.r .cell-code}\n# Pvalue f\npf(F, p, n - p, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          [,1]\n[1,] 0.8214234\n```\n\n\n:::\n\n```{.r .cell-code}\n# Titik kritis T^2\n((n*p - p)/(n - p))*qf(0.05, p, n-p, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 14.28286\n```\n\n\n:::\n:::\n\n\nApa kesimpulannya?\n\n::: {.callout-tip}\n## Hotelling's $T^2$ Dengan Library\n\nPenggunaan library kurang disarankan untuk pengerjaan karena proses penghitungan tidak terlihat, tetapi penggunaan library ini bagus untuk crosschecking jawaban kalian.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nICSNP::HotellingsT2(data, mu = mu, test = \"f\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHotelling's one sample T2-test\n\ndata:  data\nT.2 = 0.3774, df1 = 4, df2 = 16, p-value = 0.8214\nalternative hypothesis: true location is not equal to c(48,49,50,51)\n```\n\n\n:::\n:::\n\n\n(Pastikan install library `ICSNP`)\n\n:::\n\n# Uji Beda Mean 2 Sampel Multivariat Independen\n\nDalam uji beda mean 2 sampel multivariat saling independen, hipotesis yang ingin kita uji adalah\n\n| $H_0: \\pmb{\\mu_1} = \\pmb{\\mu_2}$\n| $H_1: \\pmb{\\mu_1} \\neq \\pmb{\\mu_2}$\n\ndengan $\\pmb{\\mu_1}$, $\\pmb{\\mu_2}$ adalah vektor mean dari variabel-variabel sampel acak yang ingin diuji.\n\nStatistik uji yang digunakan adalah:\n\n![](static\\Tsq_2sample.png)\n\ndengan\n\n![](static\\spl.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $T^2 \\geq T^2_{\\alpha, p, n_1+n_2-2}$\n\natau dengan pendekatan distribusi $F$\n\n![](static\\tsq_to_f_2sample.png)\n\n### Implementasi Program\n\nGunakan tabel 5.9\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv('https://raw.githubusercontent.com/farhanage/dataset-for-study/refs/heads/main/Analisis%20Multivariat/Tabel%205.9%20(Number%20of%20Words%20and%20Number%20of%20Verbs).csv', sep=';')\n\ndata\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Student  y1 y2  x1 x2\n1        1 148 20 137 15\n2        2 159 24 164 25\n3        3 144 19 224 27\n4        4 103 18 208 33\n5        5 121 17 178 24\n6        6  89 11 128 20\n7        7 119 17 154 18\n8        8 123 13 158 16\n9        9  76 16 102 21\n10      10 217 29 214 25\n11      11 148 22 209 24\n12      12 151 21 151 16\n13      13  83  7 123 13\n14      14 135 20 161 22\n15      15 178 15 175 23\n```\n\n\n:::\n:::\n\n\nAkan diuji\n\n| $H_0: \\pmb{\\mu_y} = \\pmb{\\mu_x}$\n| $H_1: \\pmb{\\mu_y} \\neq \\pmb{\\mu_x}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny <- data[, 2:3]\ny\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    y1 y2\n1  148 20\n2  159 24\n3  144 19\n4  103 18\n5  121 17\n6   89 11\n7  119 17\n8  123 13\n9   76 16\n10 217 29\n11 148 22\n12 151 21\n13  83  7\n14 135 20\n15 178 15\n```\n\n\n:::\n\n```{.r .cell-code}\nx <- data[, 4:5]\nx\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    x1 x2\n1  137 15\n2  164 25\n3  224 27\n4  208 33\n5  178 24\n6  128 20\n7  154 18\n8  158 16\n9  102 21\n10 214 25\n11 209 24\n12 151 16\n13 123 13\n14 161 22\n15 175 23\n```\n\n\n:::\n\n```{.r .cell-code}\nn1 <- nrow(y)\nn2 <- nrow(x)\np <- length(y)\n\n# Vektor xbar ybar\nybar <- colMeans(y)\nybar\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       y1        y2 \n132.93333  17.93333 \n```\n\n\n:::\n\n```{.r .cell-code}\nxbar <- colMeans(x)\nxbar\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       x1        x2 \n165.73333  21.46667 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Matriks Sx dan Sy\nSy <- cov(y)\nSy\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          y1       y2\ny1 1405.7810 153.7095\ny2  153.7095  28.6381\n```\n\n\n:::\n\n```{.r .cell-code}\nSx <- cov(x)\nSx\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          x1        x2\nx1 1299.7810 137.34762\nx2  137.3476  27.98095\n```\n\n\n:::\n\n```{.r .cell-code}\n# Hitung Spl\nSpl <- 1/(n1 + n2 - 2) * ((n1 - 1) * Sy + (n2 - 1) * Sx)\nSpl\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          y1        y2\ny1 1352.7810 145.52857\ny2  145.5286  28.30952\n```\n\n\n:::\n\n```{.r .cell-code}\n# Hitung T^2\nT2 <- (n1 * n2)/(n1 + n2) * t(ybar - xbar) %*% solve(Spl) %*% (ybar - xbar)\nT2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]\n[1,] 5.964616\n```\n\n\n:::\n:::\n\n\nAtau dengan bantuan library `DescTools`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DescTools)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nHotellingsT2Test(y, x, test='chi')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHotelling's two sample T2-test\n\ndata:  y and x\nT.2 = 5.9646, df = 2, p-value = 0.05068\nalternative hypothesis: true location difference is not equal to c(0,0)\n```\n\n\n:::\n:::\n\n\n## Uji t 2 Sampel Univariat Ketika H0 Ditolak\n\nKetika $H_0$ ditolak, gunakan uji t 2 sampel pada masing-masing variabel\n\n| $H_0: \\mu_1 = \\mu_2$\n| $H_1: \\mu_1 \\neq \\mu_2$\n\ndengan statistik uji\n\n![](static\\t_sample_univ.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $|t| > t_{\\alpha/2, n_1+n_2-2}$\n\n### Implementasi Kode\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_values <- c()\np_values <- c()\n\nfor (i in 1:ncol(y)){\n  test <- t.test(y[, i], x[, i], mu=0, var.equal=TRUE)\n  t_values[i] <- test$statistic\n  p_values[i] <- test$p.value\n}\n\nt_values\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -2.442253 -1.818649\n```\n\n\n:::\n\n```{.r .cell-code}\n# t penolakan\nqt(0.025, n1+n2-2, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.048407\n```\n\n\n:::\n\n```{.r .cell-code}\np_values\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02116598 0.07967712\n```\n\n\n:::\n:::\n\n\nKesimpulannya?\n\n# Uji Beda Mean 2 Sampel Berpasangan Multivariat\n\nTinjau data tabel 5.9 sebagai data berpasangan $(\\pmb{y}, \\pmb{x})$ di mana y dan x saling berkorelasi (dependen)\n\ndapat dihitung selisih dari tiap variabel yang diukur ($d$):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$d1 <- data$y1 - data$x1\ndata$d2 <- data$y2 - data$x2\ndata\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Student  y1 y2  x1 x2   d1  d2\n1        1 148 20 137 15   11   5\n2        2 159 24 164 25   -5  -1\n3        3 144 19 224 27  -80  -8\n4        4 103 18 208 33 -105 -15\n5        5 121 17 178 24  -57  -7\n6        6  89 11 128 20  -39  -9\n7        7 119 17 154 18  -35  -1\n8        8 123 13 158 16  -35  -3\n9        9  76 16 102 21  -26  -5\n10      10 217 29 214 25    3   4\n11      11 148 22 209 24  -61  -2\n12      12 151 21 151 16    0   5\n13      13  83  7 123 13  -40  -6\n14      14 135 20 161 22  -26  -2\n15      15 178 15 175 23    3  -8\n```\n\n\n:::\n:::\n\n\nUntuk menguji\n\n| $H_0: \\pmb{\\mu_y} = \\pmb{\\mu_x}$\n| $H_1: \\pmb{\\mu_y} \\neq \\pmb{\\mu_x}$\n\nekivalen dengan menguji\n\n| $H_0: \\pmb{\\mu_d} = \\pmb{0}$\n| $H_1: \\pmb{\\mu_d} \\neq \\pmb{0}$\n\nMenggunakan statistik uji\n\n![](static/tsq_paired.png)\n\nTolak $H_0$ pada taraf signifikansi $\\alpha$ jika $T^2 > T^2_{\\alpha, p, n-1}$\n\n### Implementasi Kode\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- y - x\nd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     y1  y2\n1    11   5\n2    -5  -1\n3   -80  -8\n4  -105 -15\n5   -57  -7\n6   -39  -9\n7   -35  -1\n8   -35  -3\n9   -26  -5\n10    3   4\n11  -61  -2\n12    0   5\n13  -40  -6\n14  -26  -2\n15    3  -8\n```\n\n\n:::\n\n```{.r .cell-code}\ndbar <- colMeans(d)\ndbar\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        y1         y2 \n-32.800000  -3.533333 \n```\n\n\n:::\n\n```{.r .cell-code}\nSd <- cov(d)\nSd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         y1        y2\ny1 1096.029 139.90000\ny2  139.900  31.55238\n```\n\n\n:::\n\n```{.r .cell-code}\nn <- nrow(d)\np <- length(d)\n\n# Hitung T^2\nT2 <- n * t(dbar) %*% solve(Sd) %*% dbar\nT2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         [,1]\n[1,] 15.19123\n```\n\n\n:::\n:::\n\n\n# Latihan Soal\n\n![](static\\soal1_bedamean.png)\n\n![](static\\soal2_bedamean.png)",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}