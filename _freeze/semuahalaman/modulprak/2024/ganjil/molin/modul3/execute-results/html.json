{
  "hash": "fe3b84142895f51e8e1d072f08037561",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Multiple linear model\"\nsubtitle: \"Multiple linear model\"\nimage: static\\Plot regresi.png\ndescription: \"Offline di Departemen Matematika\"\ndate: 10/28/2024\npage-navigation: true\nformat: html\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n\nPengantar Model Regresi Linier Berganda Model regresi linier berganda digunakan untuk memprediksi nilai suatu variabel tergantung\n\n$$Y = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\dots + \\beta_n X_n + \\epsilon$$\n\nDi mana:\n\n$𝛽_0$ :adalah intersep atau titik potong, \n\n$𝛽_1,𝛽_2,\\dots,𝛽_𝑝$ adalah koefisien dari setiap variabel independen, dan $𝜖$ adalah error atau residual.\n\nAsumsi Model Model regresi linier berganda membutuhkan beberapa asumsi untuk menghasilkan estimasi yang valid:\n\n- Linearitas: Hubungan antara variabel dependen dan independen harus linier. Independensi: Residual harus independen satu sama lain.\n\n- Homoskedastisitas: Variansi residual harus konstan di seluruh pengamatan. Normalitas: Residual harus terdistribusi normal.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'car' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: carData\n```\n\n\n:::\n\n```{.r .cell-code}\ndata(\"Salaries\")\nhead(Salaries)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       rank discipline yrs.since.phd yrs.service  sex salary\n1      Prof          B            19          18 Male 139750\n2      Prof          B            20          16 Male 173200\n3  AsstProf          B             4           3 Male  79750\n4      Prof          B            45          39 Male 115000\n5      Prof          B            40          41 Male 141500\n6 AssocProf          B             6           6 Male  97000\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(Salaries)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t397 obs. of  6 variables:\n $ rank         : Factor w/ 3 levels \"AsstProf\",\"AssocProf\",..: 3 3 1 3 3 2 3 3 3 3 ...\n $ discipline   : Factor w/ 2 levels \"A\",\"B\": 2 2 2 2 2 2 2 2 2 2 ...\n $ yrs.since.phd: int  19 20 4 45 40 6 30 45 21 18 ...\n $ yrs.service  : int  18 16 3 39 41 6 23 45 20 18 ...\n $ sex          : Factor w/ 2 levels \"Female\",\"Male\": 2 2 2 2 2 2 2 2 2 1 ...\n $ salary       : int  139750 173200 79750 115000 141500 97000 175000 147765 119250 129000 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_1var <- lm(salary~yrs.since.phd, data = Salaries) \nsummary(model_1var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ yrs.since.phd, data = Salaries)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-84171 -19432  -2858  16086 102383 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    91718.7     2765.8  33.162   <2e-16 ***\nyrs.since.phd    985.3      107.4   9.177   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 27530 on 395 degrees of freedom\nMultiple R-squared:  0.1758,\tAdjusted R-squared:  0.1737 \nF-statistic: 84.23 on 1 and 395 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_0 <- lm(salary~ 0+yrs.since.phd, data = Salaries)\nsummary(model_0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ 0 + yrs.since.phd, data = Salaries)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-151053   -3962   35818   58578  102172 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \nyrs.since.phd   4069.5      104.2   39.05   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 53490 on 396 degrees of freedom\nMultiple R-squared:  0.7938,\tAdjusted R-squared:  0.7933 \nF-statistic:  1525 on 1 and 396 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_2var <- lm(salary~yrs.since.phd + yrs.service, data = Salaries) \nsummary(model_2var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ yrs.since.phd + yrs.service, data = Salaries)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79735 -19823  -2617  15149 106149 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    89912.2     2843.6  31.620  < 2e-16 ***\nyrs.since.phd   1562.9      256.8   6.086 2.75e-09 ***\nyrs.service     -629.1      254.5  -2.472   0.0138 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 27360 on 394 degrees of freedom\nMultiple R-squared:  0.1883,\tAdjusted R-squared:  0.1842 \nF-statistic: 45.71 on 2 and 394 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#bikin dummmy variabel manual\ndf <- Salaries\ndf$Male <- ifelse(df$sex == 'Male', 1, 0) \nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       rank discipline yrs.since.phd yrs.service  sex salary Male\n1      Prof          B            19          18 Male 139750    1\n2      Prof          B            20          16 Male 173200    1\n3  AsstProf          B             4           3 Male  79750    1\n4      Prof          B            45          39 Male 115000    1\n5      Prof          B            40          41 Male 141500    1\n6 AssocProf          B             6           6 Male  97000    1\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel1 <- lm(salary~yrs.since.phd + yrs.service + Male, data=df)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ yrs.since.phd + yrs.service + Male, data = df)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79586 -19564  -3018  15071 105898 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    82875.9     4800.6  17.264  < 2e-16 ***\nyrs.since.phd   1552.8      256.1   6.062 3.15e-09 ***\nyrs.service     -649.8      254.0  -2.558   0.0109 *  \nMale            8457.1     4656.1   1.816   0.0701 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 27280 on 393 degrees of freedom\nMultiple R-squared:  0.1951,\tAdjusted R-squared:  0.189 \nF-statistic: 31.75 on 3 and 393 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n#bikin dummy variabel pake package\nlibrary(fastDummies)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'fastDummies' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\ndataf <- dummy_cols(Salaries,select_columns ='sex')\nhead(dataf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       rank discipline yrs.since.phd yrs.service  sex salary sex_Female\n1      Prof          B            19          18 Male 139750          0\n2      Prof          B            20          16 Male 173200          0\n3  AsstProf          B             4           3 Male  79750          0\n4      Prof          B            45          39 Male 115000          0\n5      Prof          B            40          41 Male 141500          0\n6 AssocProf          B             6           6 Male  97000          0\n  sex_Male\n1        1\n2        1\n3        1\n4        1\n5        1\n6        1\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel2<- lm(salary~yrs.since.phd + yrs.service + sex_Male, data=dataf)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ yrs.since.phd + yrs.service + sex_Male, \n    data = dataf)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79586 -19564  -3018  15071 105898 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    82875.9     4800.6  17.264  < 2e-16 ***\nyrs.since.phd   1552.8      256.1   6.062 3.15e-09 ***\nyrs.service     -649.8      254.0  -2.558   0.0109 *  \nsex_Male        8457.1     4656.1   1.816   0.0701 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 27280 on 393 degrees of freedom\nMultiple R-squared:  0.1951,\tAdjusted R-squared:  0.189 \nF-statistic: 31.75 on 3 and 393 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n#tanpa buat dummy variabel\nmodel3 <-lm(salary~yrs.since.phd + yrs.service + sex, data=Salaries)\nsummary(model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ yrs.since.phd + yrs.service + sex, data = Salaries)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79586 -19564  -3018  15071 105898 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    82875.9     4800.6  17.264  < 2e-16 ***\nyrs.since.phd   1552.8      256.1   6.062 3.15e-09 ***\nyrs.service     -649.8      254.0  -2.558   0.0109 *  \nsexMale         8457.1     4656.1   1.816   0.0701 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 27280 on 393 degrees of freedom\nMultiple R-squared:  0.1951,\tAdjusted R-squared:  0.189 \nF-statistic: 31.75 on 3 and 393 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n#ganti base level\nSalaries$sex <- relevel(Salaries$sex, ref='Male')\n\nmodel4 <-lm(salary~yrs.since.phd + yrs.service + relevel(sex, ref='Male'), data=Salaries)\nsummary(model4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = salary ~ yrs.since.phd + yrs.service + relevel(sex, \n    ref = \"Male\"), data = Salaries)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79586 -19564  -3018  15071 105898 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                       91333.0     2941.2  31.053  < 2e-16 ***\nyrs.since.phd                      1552.8      256.1   6.062 3.15e-09 ***\nyrs.service                        -649.8      254.0  -2.558   0.0109 *  \nrelevel(sex, ref = \"Male\")Female  -8457.1     4656.1  -1.816   0.0701 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 27280 on 393 degrees of freedom\nMultiple R-squared:  0.1951,\tAdjusted R-squared:  0.189 \nF-statistic: 31.75 on 3 and 393 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndatareg <- read.csv(\"https://raw.githubusercontent.com/aslab-math-ui/modul-prak/refs/heads/main/semuahalaman/modulprak/2024/ganjil/molin/datasets/datareg.csv\")\nhead(datareg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  gaji kesenangan\n1    6         14\n2    9         28\n3   12         50\n4   14         70\n5   30         89\n6   35         94\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(datareg$gaji, datareg$kesenangan)\n```\n\n::: {.cell-output-display}\n![](modul3_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Model linear (orde 1)\nlinearModel <- lm(kesenangan ~ gaji, data=datareg)\nsummary(linearModel)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = kesenangan ~ gaji, data = datareg)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-39.34 -21.99  -2.03  23.50  35.11 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept)  48.4531    17.3288   2.796   0.0208 *\ngaji          0.2981     0.4599   0.648   0.5331  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 28.72 on 9 degrees of freedom\nMultiple R-squared:  0.0446,\tAdjusted R-squared:  -0.06156 \nF-statistic: 0.4201 on 1 and 9 DF,  p-value: 0.5331\n```\n\n\n:::\n\n```{.r .cell-code}\n#Model Kuadratik (orde 2)\ndatareg$gajikuadrat <- datareg$gaji^2\nhead(datareg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  gaji kesenangan gajikuadrat\n1    6         14          36\n2    9         28          81\n3   12         50         144\n4   14         70         196\n5   30         89         900\n6   35         94        1225\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelkuadratik <- lm(kesenangan~gaji + gajikuadrat, data=datareg)\nmodelkuadratik <- lm(kesenangan~gaji + I(gaji^2), data=datareg)\nsummary(modelkuadratik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = kesenangan ~ gaji + I(gaji^2), data = datareg)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2484 -3.7429 -0.1812  1.1464 13.6678 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -18.25364    6.18507  -2.951   0.0184 *  \ngaji          6.74436    0.48551  13.891 6.98e-07 ***\nI(gaji^2)    -0.10120    0.00746 -13.565 8.38e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.218 on 8 degrees of freedom\nMultiple R-squared:  0.9602,\tAdjusted R-squared:  0.9502 \nF-statistic: 96.49 on 2 and 8 DF,  p-value: 2.51e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n#Model Kubik (orde 3)\ndatareg$gajikubik <- datareg$gaji^3\nmodelkubik <- lm(kesenangan~gaji + gajikuadrat + gajikubik, data=datareg)\nmodelkubik <- lm(kesenangan~gaji + I(gaji^2) + I(gaji^3), data=datareg)\nsummary(modelkubik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = kesenangan ~ gaji + I(gaji^2) + I(gaji^3), data = datareg)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.1251 -1.2526 -0.2991  1.4780  9.4979 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -3.715e+01  1.076e+01  -3.454 0.010639 *  \ngaji         9.610e+00  1.482e+00   6.486 0.000338 ***\nI(gaji^2)   -2.022e-01  5.052e-02  -4.001 0.005182 ** \nI(gaji^3)    9.968e-04  4.949e-04   2.014 0.083855 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.289 on 7 degrees of freedom\nMultiple R-squared:  0.9748,\tAdjusted R-squared:  0.964 \nF-statistic: 90.26 on 3 and 7 DF,  p-value: 5.856e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n#Compare model kuadratik sama kubik\nanova(modelkuadratik,modelkubik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: kesenangan ~ gaji + I(gaji^2)\nModel 2: kesenangan ~ gaji + I(gaji^2) + I(gaji^3)\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1      8 309.34                              \n2      7 195.84  1     113.5 4.0567 0.08385 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n#plot regresi \nplot(datareg$gaji, datareg$kesenangan)\n#Mengeluarkan nilai gaji\nnilaigaji <- seq(0, 60, 0.1)\n#Mengeluarkan nilai prediksi dari model kuadratik\npredkesenangan <- predict(modelkuadratik,list(gaji=nilaigaji, gajikuadrat=nilaigaji^2))\n#Mengeluarkan Plot dengan garis\nlines(nilaigaji, predkesenangan, col='red')\n```\n\n::: {.cell-output-display}\n![](modul3_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nModel Interaksi Interaksi memungkinkan kita untuk menguji apakah efek dari satu variabel independen pada $𝑌$ dipengaruhi oleh variabel independen lain. Model interaksi dapat dituliskan sebagai:\n\n$$𝑌=𝛽_0 +𝛽_1 𝑋_1 + 𝛽_2𝑋_2 +𝛽_3(𝑋_1×𝑋_2)+𝜖$$\n\nKoefisien $𝛽_3$ menunjukkan efek interaksi antara $𝑋_1$ dan $𝑋_2$ .\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnilai_UTS <- read.csv(\"https://raw.githubusercontent.com/aslab-math-ui/modul-prak/refs/heads/main/semuahalaman/modulprak/2024/ganjil/molin/datasets/nilai_UTS.csv\")\nhead(nilai_UTS)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  nilai_UTS  IQ JenisKelamin\n1        93 125         Male\n2        86 120       Female\n3        96 115         Male\n4        81 110       Female\n5        92 105         Male\n6        75 100       Female\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(nilai_UTS)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t10 obs. of  3 variables:\n $ nilai_UTS   : int  93 86 96 81 92 75 84 77 73 74\n $ IQ          : int  125 120 115 110 105 100 95 90 85 80\n $ JenisKelamin: chr  \"Male\" \"Female\" \"Male\" \"Female\" ...\n```\n\n\n:::\n\n```{.r .cell-code}\nGenderMale <- nilai_UTS[which(nilai_UTS$JenisKelamin==\"Male\"),]\nGenderFemale <- nilai_UTS[which(nilai_UTS$JenisKelamin==\"Female\"),]\n\nmodelMale <- lm(nilai_UTS ~ IQ, data = GenderMale)\nmodelFemale <- lm(nilai_UTS ~ IQ, data = GenderFemale)\n\n#Ngeluarin plot dengan garis \nplot(nilai_UTS$IQ, nilai_UTS$nilai_UTS)\nlines(GenderMale$IQ, predict(modelMale), col=\"red\",\n      lty = 1 , lwd = 2)\nlines(GenderFemale$IQ, predict(modelFemale), col=\"blue\",\n      lty = 2 , lwd = 2)\nlegend(\"topleft\", legend=c('Male','Female'), col=c('red','blue'),\n       lty = c(1,2), lwd=c(2,2))\n```\n\n::: {.cell-output-display}\n![](modul3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nTransformasi Variabel Jika asumsi linearitas atau homoskedastisitas tidak terpenuhi, transformasi variabel dapat membantu. Contoh transformasi yang sering digunakan meliputi:\n\n- **Logaritma** untuk mengatasi ketidakseimbangan skala. \n- **Kuadrat atau akar** untuk mengurangi heteroskedastisitas.\n\nPengujian Model Dalam mengevaluasi model, kita biasanya menggunakan beberapa metrik:\n\n- **R-squared ( $𝑅^2$ )**: Mengukur proporsi variabilitas $𝑌$ yang dapat dijelaskan oleh model. \n\n- **Adjusted $𝑅^2$** : Mengoreksi nilai $𝑅^2$ dengan mempertimbangkan jumlah variabel independen. \n\n- **F-Test**: Untuk menguji apakah setidaknya satu dari variabel independen berkontribusi signifikan terhadap prediksi $Y$.\n",
    "supporting": [
      "modul3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}